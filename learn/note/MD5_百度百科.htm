<!DOCTYPE html>
<!--STATUS OK-->
<html>



<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="referrer" content="always" />
<meta name="description" content="Message Digest Algorithm MD5（中文名为消息摘要算法第五版）为计算机安全领域广泛使用的一种散列函数，用以提供消息的完整性保护。该算法的文件号为RFC 1321（R.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992）。MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是...">
<title>MD5_百度百科</title>
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link rel="icon" sizes="any" mask href="//www.baidu.com/img/baidu.svg">

<meta name="keywords" content="MD5 MD5值 MD5算法 MD5发展历史 MD5MD5应用 MD5算法原理 MD5弱点">
<meta name="image" content="http://baike.bdimg.com/cms/static/baike.png">
<script type="text/javascript">
  // 配置 PD 监控。
  window.alogObjectConfig = {
    product: '103',
    page: '103_',
    monkey_page: '',
    speed_page: '',
    speed: {
      sample: '1'
    },
    monkey: {
      sample: '1',
      hid: '1533'
    },
    exception: { 
      sample: '1'
    },
    feature: {
      sample: '1'
    },
    csp: {
      sample: '1',
      'default-src': [
        {match: '*.baidu.com,*.bdimg.com,localhost', target: 'Accept'},
        {match: '*', target: 'Accept,Warn'}
      ]
    }
  };

  void function(a,b,c,d,e,f,g){if(a.alogObjectName=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=a[e].l||+new Date,"https:"===a.location.protocol){if(d="https://gss2.bdstatic.com/70cFsjip0QIZ8tyhnq"+d,!a.alogObjectConfig||!a.alogObjectConfig.sample)return}else d="http://img.baidu.com"+d;var h=!0;if(a.alogObjectConfig&&a.alogObjectConfig.sample){var i=Math.random();a.alogObjectConfig.rand=i,i>a.alogObjectConfig.sample&&(h=!1)}h&&(f=b.createElement(c),f.async=!0,f.src=d,g=b.getElementsByTagName(c)[0],g.parentNode.insertBefore(f,g))}(window,document,"script","/hunter/alog/alog.min.js","alog"),void function(){function a(){}window.PDC={mark:function(a,b){alog("speed.set",a,b||+new Date),alog.fire&&alog.fire("mark")},init:function(a){alog("speed.set","options",a)},view_start:a,tti:a,page_ready:a}}();void function(n){var o=!1;n.onerror=function(n,e,t,c){var i=!0;return!e&&/^script error/i.test(n)&&(o?i=!1:o=!0),i&&alog("exception.send","exception",{msg:n,js:e,ln:t,col:c}),!1},alog("exception.on","catch",function(n){alog("exception.send","exception",{msg:n.msg,js:n.path,ln:n.ln,method:n.method,flag:"catch"})})}(window);
</script>
<meta name="csrf-token" content="">

<!--[if lte IE 9]>
<script>
    (function() {
      var e = "abbr,article,aside,audio,canvas,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(","),
        i = e.length;
      while (i--) {
        document.createElement(e[i]);
      }
    })();
  </script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/pkg/wiki-lemma_7850da5.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/pkg/wiki-common-base_b4e62b7.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/userbar/userbar_9fb5389.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/searchbar/searchbar_main_f9c7c20.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/navbar/navbar_0697c78.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/announcement/announcement_b0d7681.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/unameFiller/unameFiller_d631c34.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/label/label_461cbe0.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/newSideShare/sideShare_ebee986.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/praise/praise_2120cd2.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/video/pageMask/pageMask_ff9a193.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/pkg/wiki-lemma-module_1709cbf.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/userCard/userCard_2402f1f.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/style/shCore_7fba49a.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/style/shCoreDefault_3f91dc3.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/mainContent/mainContent_1a67233.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/mainContent/lemmaRelation/lemmaRelation_9f629f5.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/configModule/zhixin/zhixin_1c34583.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-common/widget/component/footer/footer_main_eb7bd79.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/searchHeader/toolButtons/toolButtons-o_a2c470f.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/searchHeader/toolButtons/userInfo-o_9ba20c1.css"/><link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/wiki-lemma/widget/tools/searchHeader/searchHeader-o_e786bfb.css"/></head>

<script type="text/javascript">
    alog('speed.set', 'ht', +new Date);
</script>

<body class="wiki-lemma normal">



<div class="header-wrapper">
<ul class="wgt-userbar">
<li>
<a href="http://www.baidu.com/">百度首页</a>
</li>
</ul>
<div class="header">
<div class="layout">
<div class="wgt-searchbar wgt-searchbar-main cmn-clearfix">
<div class="logo-container">
<a class="logo cmn-inline-block" title="到百科首页" href="/">
<span class="cmn-baike-logo">
<em class="cmn-icon cmn-icons cmn-icons_logo-bai"></em>
<em class="cmn-icon cmn-icons cmn-icons_logo-du"></em>
<em class="cmn-icon cmn-icons cmn-icons_logo-baike"></em>
</span>
</a>
</div>
<div class="search">
<div class="nav">
<a href="http://news.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://news.baidu.com/ns?tn=news&cl=2&rn=20&ct=1&fr=bks0000&ie=utf-8&word=">新闻</a>
<a href="http://www.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://www.baidu.com/s?ie=utf-8&fr=bks0000&wd=">网页</a>
<a href="http://tieba.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://tieba.baidu.com/f?ie=utf-8&fr=bks0000&kw=">贴吧</a>
<a href="http://zhidao.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://zhidao.baidu.com/search?pn=0&&rn=10&lm=0&fr=bks0000&word=">知道</a>
<a href="http://music.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://music.baidu.com/search?f=ms&ct=134217728&ie=utf-8&rn=&lm=-1&pn=30fr=bks0000&key=">音乐</a>
<a href="http://image.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://image.baidu.com/search/index?tn=baiduimage&ct=201326592&lm=-1&cl=2&nc=1&ie=utf-8&word=">图片</a>
<a href="http://v.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://v.baidu.com/v?ct=301989888&rn=20&pn=0&db=0&s=22&ie=utf-8&fr=bks0000&word=">视频</a>
<a href="http://map.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://map.baidu.com/m?ie=utf-8&fr=bks0000&word=">地图</a>
<a class="baike" nslog="normal" nslog-type="10080001" >百科</a>
<a href="http://wenku.baidu.com/" nslog="normal" nslog-type="10080001" data-href="http://wenku.baidu.com/search?lm=0&od=0&ie=utf-8&fr=bks0000&word=">文库</a>
</div>
<div class="form">
<form id="searchForm" action="/search/word" method="GET" target="_self">
<input id="query" nslog="normal" nslog-type="10080005" name="word" type="text" autocomplete="off" autocorrect="off" value="MD5" /><button id="search" nslog="normal" nslog-type="10080002" type="button">进入词条</button><button id="searchLemma" nslog="normal" nslog-type="10080003" type="button">搜索词条</button><a class="help" nslog="normal" nslog-type="10080004" href="/help" target="_blank">帮助</a>
</form>
<form id="searchLemmaForm" action="/search" method="GET" target="_self">
<input id="searchLemmaQuery" name="word" type="hidden" />
<input name="pn" type="hidden" value="0" />
<input name="rn" type="hidden" value="0" />
<input name="enc" type="hidden" value="utf8" />
</form>
<ul id="suggestion" class="suggestion">
<div class="sug"></div>
<li class="extra">
<span id="close" nslog="normal" nslog-type="10080006" >关闭</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="navbar-wrapper">
<div class="wgt-navbar">
<div class="navbar-bg">
<div class="navbar-bg-top">
<div class="navbar-content layout">
<div class="navbar-content-box">
<dl class="index ">
<dt><a href="/">首页</a></dt>
</dl>
<dl class="cat ">
<dt><a>分类</a></dt>
<dd>
<div><a href="/art" target="_blank" class="art">艺术</a></div>
<div><a href="/science" target="_blank" class="technology">科学</a></div>
<div><a href="/ziran" target="_blank">自然</a></div>
<div><a href="/wenhua" target="_blank">文化</a></div>
<div><a href="/dili" target="_blank">地理</a></div>
<div><a href="/shenghuo" target="_blank">生活</a></div>
<div><a href="/shehui" target="_blank">社会</a></div>
<div><a href="/renwu" target="_blank">人物</a></div>
<div><a href="/jingji" target="_blank">经济</a></div>
<div><a href="/tiyu" target="_blank">体育</a></div>
<div><a href="/lishi" target="_blank">历史</a></div>
</dd>
</dl>
<dl class="special ">
<dt><a>特色百科</a></dt>
<dd>
<div><a href="/calendar/" target="_blank">历史上的今天</a></div>
<div><a href="/museum/" target="_blank">数字博物馆</a></div>
<div><a href="/shiji/2015?fr=navbar" target="_blank">史记·2015</a></div>
<div><a href="/city/" target="_blank">城市百科</a></div>
<div><a href="/operation/worldwar2" target="_blank">二战百科</a></div>
<div><a href="/feiyi?fr=dhlfeiyi" target="_blank">非遗百科</a></div>
</dd>
</dl>
<dl class="user" >
<dt><a>用户</a></dt>
<dd>
<div><a href="/kedou/" target="_blank">蝌蚪团</a></div>
<div><a href="/event/ranmeng/" target="_blank">燃梦计划</a></div>
<div><a href="/task/" target="_blank">百科任务</a></div>
<div><a href="/mall/" target="_blank">百科商城</a></div>
</dd>
</dl>
<dl class="cooperation" >
<dt><a>权威合作</a></dt>
<dd>
<div><a href="/operation/cooperation#joint" target="_blank">合作模式</a></div>
<div><a href="/operation/cooperation#issue" target="_blank">常见问题</a></div>
<div><a href="/operation/cooperation#connection" target="_blank">联系方式</a></div>
</dd>
</dl>
<dl class="mobile" >
<dt><a>手机百科</a></dt>
<dd>
<div><a href="/m#wap" target="_blank">网页版</a></div>
</dd>
</dl>
<div class="usercenter">
<div><a href="/usercenter" target="_blank"><em class="cmn-icon cmn-icons cmn-icons_navbar-usercenter"></em>个人中心</a></div>
</div></div>
</div>
</div>
</div>
</div>
</div>


<div class="body-wrapper">
<div class="before-content">
</div>
<div class="content-wrapper">
<div class="content">
<div class="personal-content">
</div>
<div class="main-content">
<div class="top-tool">
<a class="add-sub-icon" href="javascript:;" title="添加义项" nslog-type="50000101"></a>
<a href="/divideload/MD5" title="拆分词条" target="_blank" class="split-icon" style="display:none;" nslog-type="50000104"></a>
<div class="top-collect" nslog="area" nslog-type="50000102">
<span class="collect-text">收藏</span>
<div class="collect-tip">查看<a href="/uc/favolemma" target="_blank">我的收藏</a></div>
</div>
<a href="javascript:void(0);" class="top-vote" nslog-type="50000103">
<span class="vote-count">0</span>
<span class="vote-tip">有用+1</span>
<span class="voted-tip">已投票</span>
</a>
<div class="bdsharebuttonbox top-share" data-tag="top-share">
<a class="bds_more top-share-icon" data-cmd="more" nslog-type="9067">
<span class="bds_count share-count" id="j-topShareCount" data-cmd="count">0</span>
</a>
</div>
</div>
<div style="width:0;height:0;clear:both"></div><dl class="lemmaWgt-lemmaTitle lemmaWgt-lemmaTitle-">
<dd class="lemmaWgt-lemmaTitle-title">
<h1 >MD5</h1>
<a href="javascript:;" class="edit-lemma cmn-btn-hover-blue cmn-btn-28 j-edit-link"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_edit-lemma"></em>编辑</a>
<a class="lock-lemma" target="_blank" href="/view/10812319.htm" title="锁定"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_lock-lemma"></em>锁定</a>
</dd>
</dl><div class="promotion-declaration">
</div><div class="lemma-summary" label-module="lemmaSummary">
<div class="para" label-module="para">Message Digest Algorithm MD5（中文名为<a target=_blank href="/view/2313810.htm">消息摘要算法</a>第五版）为计算机安全领域广泛使用的一种散列函数，用以提供消息的完整性保护。该算法的文件号为RFC 1321（R.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992）。</div><div class="para" label-module="para"><b>MD5</b>即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一（又译<a target=_blank href="/view/10961371.htm">摘要算法</a>、<a target=_blank href="/view/273836.htm">哈希算法</a>），主流编程语言普遍已有MD5实现。将数据（如汉字）运算为另一固定长度值，是杂凑算法的基础原理，MD5的前身有MD2、<a target=_blank href="/view/2535629.htm">MD3</a>和<a target=_blank href="/view/444142.htm">MD4</a>。</div><div class="para" label-module="para">MD5算法具有以下特点：</div><div class="para" label-module="para">1、压缩性：任意长度的数据，算出的MD5值长度都是固定的。</div><div class="para" label-module="para">2、容易计算：从原数据计算出MD5值很容易。</div><div class="para" label-module="para">3、抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。</div><div class="para" label-module="para">4、强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。</div><div class="para" label-module="para">MD5的作用是让大容量信息在用<a target=_blank href="/view/7626.htm">数字签名</a>软件签署私人<a target=_blank href="/view/934.htm">密钥</a>前被&quot;<a target=_blank href="/subview/786588/12546221.htm" data-lemmaid="13032501">压缩</a>&quot;成一种保密的格式（就是把一个任意长度的字节串变换成一定长的<a target=_blank href="/view/230306.htm">十六进制</a>数字串）。除了MD5以外，其中比较有名的还有<a target=_blank href="/view/94209.htm">sha-1</a>、<a target=_blank href="/view/260854.htm">RIPEMD</a>以及Haval等。</div>
</div>
<div class="configModuleBanner">
</div><div class="basic-info cmn-clearfix">
<dl class="basicInfo-block basicInfo-left">
<dt class="basicInfo-item name">中文名</dt>
<dd class="basicInfo-item value">
消息摘要算法
</dd>
<dt class="basicInfo-item name">外文名</dt>
<dd class="basicInfo-item value">
Message Digest Algorithm MD5
</dd>
<dt class="basicInfo-item name">别&nbsp;&nbsp;&nbsp;&nbsp;称</dt>
<dd class="basicInfo-item value">
摘要算法
</dd>
</dl><dl class="basicInfo-block basicInfo-right">
<dt class="basicInfo-item name">提出时间</dt>
<dd class="basicInfo-item value">
1991年
</dd>
<dt class="basicInfo-item name">应用学科</dt>
<dd class="basicInfo-item value">
信息技术，计算机科学
</dd>
<dt class="basicInfo-item name">适用领域范围</dt>
<dd class="basicInfo-item value">
软件下载站、论坛数据库、系统文件安全
</dd>
</dl></div>
<div class="lemmaWgt-lemmaCatalog">
<div class="lemma-catalog">
<h2 class="block-title">目录</h2>
<div class="catalog-list column-3">
<ol>
<li class="level1">
<span class="index">1</span>
<span class="text"><a href="#1">发展历史</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#1_1">MD2</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#1_2">MD4</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#1_3">MD5</a></span>
</li>
<li class="level1">
<span class="index">2</span>
<span class="text"><a href="#2">MD5应用</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#2_1">一致性验证</a></span>
</li>
</ol><ol><li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#2_2">数字签名</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#2_3">安全访问认证</a></span>
</li>
<li class="level1">
<span class="index">3</span>
<span class="text"><a href="#3">算法原理</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_1">原理</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_2">MD5加密字符串实例</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_3">C++实现</a></span>
</li>
</ol><ol><li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_4">JAVA实现</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_5">VB2010实现</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_6">JavaScript实现</a></span>
</li>
<li class="level2">
<span class="index">▪</span>
<span class="text"><a href="#3_7">伪代码实现</a></span>
</li>
<li class="level1">
<span class="index">4</span>
<span class="text"><a href="#4">弱点</a></span>
</li>
</ol>

</div>
</div>
</div>
<div class="anchor-list">
<a name="1" class="lemma-anchor para-title" ></a>
<a name="sub7636_1" class="lemma-anchor " ></a>
<a name="发展历史" class="lemma-anchor " ></a>
</div><div class="para-title level-2" label-module="para-title">
<h2 class="title-text"><span class="title-prefix">MD5</span>发展历史</h2>
<a class="edit-icon j-edit-link" data-edit-dl="1" href="javascript:;"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_edit-lemma"></em>编辑</a>
</div>
<div class="anchor-list">
<a name="1_1" class="lemma-anchor para-title" ></a>
<a name="sub7636_1_1" class="lemma-anchor " ></a>
<a name="MD2" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>MD2</h3>
</div>
<div class="para" label-module="para">Rivest在1989年开发出MD2算法。在这个算法中，首先对信息进行数据补位，使信息的字节长度是16的倍数。然后，以一个16位的检验和追加到信息末尾，并且根据这个新产生的信息计算出散列值。后来，Rogier和Chauvaud发现如果忽略了检验将和MD2产生冲突。MD2算法<a target=_blank href="/view/40927.htm">加密</a>后结果是唯一的（即不同信息加密后的结果不同）。</div><div class="anchor-list">
<a name="1_2" class="lemma-anchor para-title" ></a>
<a name="sub7636_1_2" class="lemma-anchor " ></a>
<a name="MD4" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>MD4</h3>
</div>
<div class="para" label-module="para">为了加<div class="lemma-picture text-pic layout-right" style="width:220px; float: right;">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/020e66f09887dc877831aa53?fr=lemma&ct=single" target="_blank"
		title="MD5" style="width:220px;height:165px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://h.hiphotos.baidu.com/baike/s%3D220/sign=ed3ad55aa8d3fd1f3209a538004f25ce/aa18972bd40735fa897c08cd9e510fb30f240831.jpg"  alt="MD5" style="width:220px;height:165px;"/>
</a>
<span class="description">
MD5
</span>
</div>强算法的安全性，Rivest在1990年又开发出MD4算法。MD4算法同样需要填补信息以确保信息的比特位长度减去448后能被512整除（信息比特位长度mod 512 = 448）。然后，一个以64位<a target=_blank href="/view/18536.htm">二进制</a>表示的信息的最初长度被添加进来。信息被处理成512位damg?rd/merkle迭代结构的区块，而且每个区块要通过三个不同步骤的处理。Den boer和Bosselaers以及其他人很快的发现了攻击MD4版本中第一步和第三步的漏洞。Dobbertin向大家演示了如何利用一部普通的个人电脑在几分钟内找到MD4完整版本中的冲突（这个冲突实际上是一种漏洞，它将导致对不同的内容进行加密却可能得到相同的加密后结果）。毫无疑问，MD4就此被淘汰掉了。</div>
<div class="para" label-module="para">尽管MD4算法在安全上有个这么大的漏洞，但它对在其后才被开发出来的好几种信息安全加密算法的出现却有着不可忽视的引导作用。</div><div class="anchor-list">
<a name="1_3" class="lemma-anchor para-title" ></a>
<a name="sub7636_1_3" class="lemma-anchor " ></a>
<a name="MD5" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>MD5</h3>
</div>
<div class="para" label-module="para">1991年，Rivest开发出技术上更为趋近成熟的<a target=_blank href="/view/706946.htm">md5算法</a>。它在MD4的基础上增加了"安全-带子"（safety-belts）的概念。虽然MD5比MD4复杂度大一些，但却更为安全。这个算法很明显的由四个和MD4设计有少许不同的步骤组成。在<a target=_blank href="/view/706946.htm">MD5算法</a>中，信息-摘要的大小和填充的必要条件与MD4完全相同。Den boer和Bosselaers曾发现MD5算法中的假冲突（pseudo-collisions），但除此之外就没有其他被发现的加密后结果了。</div><div class="anchor-list">
<a name="2" class="lemma-anchor para-title" ></a>
<a name="sub7636_2" class="lemma-anchor " ></a>
<a name="MD5应用" class="lemma-anchor " ></a>
</div><div class="para-title level-2" label-module="para-title">
<h2 class="title-text"><span class="title-prefix">MD5</span>MD5应用</h2>
<a class="edit-icon j-edit-link" data-edit-dl="2" href="javascript:;"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_edit-lemma"></em>编辑</a>
</div>
<div class="anchor-list">
<a name="2_1" class="lemma-anchor para-title" ></a>
<a name="sub7636_2_1" class="lemma-anchor " ></a>
<a name="一致性验证" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>一致性验证</h3>
</div>
<div class="para" label-module="para">MD5的<div class="lemma-picture text-pic layout-right" style="width:220px; float: right;">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/e6508eef7570d4abcf1b3e5f?fr=lemma&ct=single" target="_blank"
		title="md5" style="width:220px;height:161px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://d.hiphotos.baidu.com/baike/s%3D220/sign=f1a9cd4d6b63f624185d3e01b745eb32/caef76094b36acaf2d6bd0887cd98d1001e99c3e.jpg"  alt="md5" style="width:220px;height:161px;"/>
</a>
<span class="description">
md5
</span>
</div>典型应用是对一段信息（Message）产生信息摘要（Message-Digest），以防止被篡改。比如，在<a target=_blank href="/view/8095.htm">Unix</a>下有很多软件在下载的时候都有一个文件名相同，文件扩展名为.md5的文件，在这个文件中通常只有一行文本，大致结构如：</div>
<div class="para" label-module="para">MD5 (tanajiya.tar.gz) = 38b8c2c1093dd0fec383a9d9ac940515</div>
<div class="para" label-module="para">这就是tanajiya.tar.gz文件的数字签名。MD5将整个文件当作一个大文本信息，通过其不可逆的字符串变换算法，产生了这个唯一的MD5信息摘要。为了让读者朋友对MD5的应用有个直观的认识，笔者以一个比方和一个实例来简要描述一下其工作过程：</div>
<div class="para" label-module="para">大家都知道，地球上任何人都有自己独一无二的<a target=_blank href="/view/5628.htm">指纹</a>，这常常成为司法机关鉴别罪犯身份最值得信赖的方法；与之类似，MD5就可以为任何文件（不管其大小、格式、数量）产生一个同样独一无二的<div class="lemma-picture text-pic layout-right" style="width:220px; float: right;">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/bd7faf351443f1cfa71e125a?fr=lemma&ct=single" target="_blank"
		title="md5" style="width:220px;height:176px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://h.hiphotos.baidu.com/baike/s%3D220/sign=42817f93912397ddd2799f066983b216/2cf5e0fe9925bc317bd947ec5edf8db1cb137039.jpg"  alt="md5" style="width:220px;height:176px;"/>
</a>
<span class="description">
md5
</span>
</div>“<a target=_blank href="/view/962481.htm">数字指纹</a>”，如果任何人对文件做了任何改动，其<a target=_blank href="/view/1047696.htm">MD5值</a>也就是对应的“数字指纹”都会发生变化。</div>
<div class="para" label-module="para">我们常常在某些软件下载站点的某软件信息中看到其MD5值，它的作用就在于我们可以在下载该软件后，对下载回来的文件用专门的软件（如Windows MD5 Check等）做一次<a target=_blank href="/view/274197.htm">MD5校验</a>，以确保我们获得的文件与该站点提供的文件为同一文件。</div>
<div class="para" label-module="para">具体来说文件的MD5值就像是这个文件的“<a target=_blank href="/view/962481.htm">数字指纹</a>”。每个文件的MD5值是不同的，如果任何人对文件做了任何改动，其<a target=_blank href="/view/1047696.htm">MD5值</a>也就是对应的“数字指纹”就会发生变化。比如下载服务器针对一个文件预先提供一个MD5值，用户下载完该文件后，用我这个算法重新计算下载文件的MD5值，通过比较这两个值是否相同，就能判断下载的文件是否出错，或者说下载的文件是否被篡改了。</div>
<div class="para" label-module="para">利用MD5算法来进行文件校验的方案被大量应用到软件下载站、论坛数据库、系统文件安全等方面。</div><div class="anchor-list">
<a name="2_2" class="lemma-anchor para-title" ></a>
<a name="sub7636_2_2" class="lemma-anchor " ></a>
<a name="数字签名" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>数字签名</h3>
</div>
<div class="para" label-module="para">MD5的典型应用是对一段Message(字节串)产生fingerprint(<a target=_blank href="/view/5628.htm">指纹</a>），以防止被“篡改”。举个例子，你将一段话写在一个叫 readme.txt文件中，并对这个readme.txt产生一个MD5的值并记录在案，然后你可以传播这个文件给别人，别人如果修改了文件中的任何内容，你对这个文件重新计算MD5时就会发现（两个MD5值不相同）。如果再有一个第三方的认证机构，用MD5还可以防止文件作者的“抵赖”，这就是所谓的数字签名应用。</div><div class="anchor-list">
<a name="2_3" class="lemma-anchor para-title" ></a>
<a name="sub7636_2_3" class="lemma-anchor " ></a>
<a name="安全访问认证" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>安全访问认证</h3>
</div>
<div class="para" label-module="para">MD5还广泛用于操作系统的登陆认证上，如Unix、各类<a target=_blank href="/view/4225732.htm">BSD系统</a>登录密码、<a target=_blank href="/view/7626.htm">数字签名</a>等诸多方面。如在Unix系统中用户的密码是以MD5（或其它类似的算法）经Hash运算后存储在文件系统中。当用户登录的时候，系统把用户输入的密码进行MD5 Hash运算，然后再去和保存在文件系统中的MD5值进行比较，进而确定输入的密码是否正确。通过这样的步骤，系统在并不知道用户密码的明码的情况下就可以确定用户登录系统的合法性。这可以避免用户的密码被具有系统管理员权限的用户知道。MD5将任意长度的“字节串”映射为一个128bit的大整数，并且是通过该128bit反推原始字符串是困难的，换句话说就是，即使你看到源程序和算法描述，也无法将一个MD5的值变换回原始的字符串，从数学原理上说，是因为原始的字符串有无穷多个，这有点象不存在反函数的数学函数。所以，要遇到了md5密码的问题，比较好的办法是：你可以用这个系统中的md5（）函数重新设一个密码，如admin，把生成的一串密码的Hash值覆盖原来的Hash值就行了。</div>
<div class="para" label-module="para">正是因为这个原因，现在被黑客使用最多的一种破译密码的方法就是一种被称为"跑字典"的方法。有两种方法得到字典，一种是日常搜集的用做密码的字符串表，另一种是用排列组合方法生成的，先用MD5程序计算出这些字典项的MD5值，然后再用目标的MD5值在这个字典中检索。我们假设密码的最大长度为8位字节（8 Bytes），同时密码只能是字母和数字，共26+26+10=62个字节，排列组合出的字典的项数则是P（62,1）+P（62,2）….+P（62,8），那也已经是一个很天文的数字了，存储这个字典就需要TB级的<a target=_blank href="/view/63423.htm">磁盘阵列</a>，而且这种方法还有一个前提，就是能获得目标账户的密码MD5值的情况下才可以。这种加密技术被广泛的应用于Unix系统中，这也是为什么Unix系统比一般操作系统更为坚固一个重要原因。</div><div class="anchor-list">
<a name="3" class="lemma-anchor para-title" ></a>
<a name="sub7636_3" class="lemma-anchor " ></a>
<a name="算法原理" class="lemma-anchor " ></a>
</div><div class="para-title level-2" label-module="para-title">
<h2 class="title-text"><span class="title-prefix">MD5</span>算法原理</h2>
<a class="edit-icon j-edit-link" data-edit-dl="3" href="javascript:;"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_edit-lemma"></em>编辑</a>
</div>
<div class="anchor-list">
<a name="3_1" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_1" class="lemma-anchor " ></a>
<a name="原理" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>原理</h3>
</div>
<div class="para" label-module="para">对MD5算法简要的叙述可以为：MD5以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。</div>
<div class="para" label-module="para">总体流程如下图所示，<div class="lemma-picture text-pic layout-abreast" style="width:220px; ">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/bd7faf351443f1cfa71e125a?fr=lemma&ct=single" target="_blank"
		title="" style="width:220px;height:176px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://h.hiphotos.baidu.com/baike/s%3D220/sign=42817f93912397ddd2799f066983b216/2cf5e0fe9925bc317bd947ec5edf8db1cb137039.jpg"  alt="" style="width:220px;height:176px;"/>
</a>
</div> 表示第i个分组，每次的运算都由前一轮的128位结果值和第i块512bit值进行运算。</div>
<div class="para" label-module="para" style="text-align: center;" ><div class="lemma-picture text-pic layout-center" style="width:205px; float: none; display: block; margin: 0px auto; clear: both;">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/c75c10385343fbf2ee0d9594b17eca8065388f67?fr=lemma&ct=single" target="_blank"
		title="MD5算法的整体流程图" style="width:205px;height:220px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://e.hiphotos.baidu.com/baike/s%3D220/sign=0d21201058ee3d6d26c680c973176d41/c75c10385343fbf2ee0d9594b17eca8065388f67.jpg"  alt="MD5算法的整体流程图" style="width:205px;height:220px;"/>
</a>
<span class="description">
MD5算法的整体流程图
</span>
</div></div>
<div class="para" label-module="para"><b>1.填充</b></div>
<div class="para" label-module="para">在MD5算法中，首先需要对信息进行填充，使其位长对512求余的结果等于448，<b>并且填充必须进行，即使其位长对512求余的结果等于448</b>。因此，信息的位长（Bits Length）将被扩展至N*512+448，N为一个非负整数，N可以是零。</div>
<div class="para" label-module="para">填充的方法如下：</div>
<div class="para" label-module="para"><b>1)</b> 在信息的后面填充一个1和无数个0，直到满足上面的条件时才停止用0对信息的填充。</div>
<div class="para" label-module="para"><b>2)</b> 在这个结果后面附加一个以64位二进制表示的填充前信息长度（单位为Bit），如果二</div>
<div class="para" label-module="para">进制表示的填充前信息长度超过64位，则取低64位。</div>
<div class="para" label-module="para">经过这两步的处理，信息的位长=N*512+448+64=(N+1）*512，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。</div>
<div class="para" label-module="para"><b>2. 初始化变量</b></div>
<div class="para" label-module="para">初始的128位值为初试链接变量，这些参数用于第一轮的运算，以大端<a target=_blank href="/view/2194385.htm">字节序</a>来表示，他们分别为： A=0x01234567，B=0x89ABCDEF，C=0xFEDCBA98，D=0x76543210。</div>
<div class="para" label-module="para">（每一个变量给出的数值是高字节存于内存低地址，低字节存于内存高地址，即大端字节序。在程序中变量A、B、C、D的值分别为0x67452301，0xEFCDAB89，0x98BADCFE，0x10325476）</div>
<div class="para" label-module="para"><b>3. 处理分组数据</b></div>
<div class="para" label-module="para">每一分组的算法流程如下：</div>
<div class="para" label-module="para">第一分组需要将上面四个链接变量复制到另外四个变量中：A到a，B到b，C到c，D到d。从第二分组开始的变量为上一分组的运算结果，即A = a， B = b， C = c， D = d。</div>
<div class="para" label-module="para">主循环有四轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对a、b、c和d中的其中三个作一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左<b>环移</b>一个不定的数，并加上a、b、c或d中之一。最后用该结果取代a、b、c或d中之一。</div>
<div class="para" label-module="para">以下是每次操作中用到的四个非线性函数（每轮一个）。</div>
<div class="para" label-module="para">F( X ,Y ,Z ) = ( X &amp; Y ) | ( (~X) &amp; Z )</div>
<div class="para" label-module="para">G( X ,Y ,Z ) = ( X &amp; Z ) | ( Y &amp; (~Z) )</div>
<div class="para" label-module="para">H( X ,Y ,Z ) =X ^ Y ^ Z</div>
<div class="para" label-module="para">I( X ,Y ,Z ) =Y ^ ( X | (~Z) )</div>
<div class="para" label-module="para">（&amp;是与（And），|是或（Or），~是非（Not），^是异或（Xor））</div>
<div class="para" label-module="para">这四个函数的说明：如果X、Y和Z的对应位是独立和均匀的，那么结果的每一位也应是独立和均匀的。</div>
<div class="para" label-module="para">F是一个逐位运算的函数。即，如果X，那么Y，否则Z。函数H是逐位奇偶操作符。</div>
<div class="para" label-module="para">假设Mj表示消息的第j个子分组（从0到15），常数ti是4294967296*abs( sin(i) ）的整数部分，i 取值从1到64，单位是弧度。（4294967296=2<sup class="normal">32</sup>）</div>
<div class="para" label-module="para">现定义：</div>
<div class="para" label-module="para">FF(a ,b ,c ,d ,Mj ,s ,ti ) 操作为 a = b + ( (a + F(b,c,d) + Mj + ti) &lt;&lt; s)</div>
<div class="para" label-module="para">GG(a ,b ,c ,d ,Mj ,s ,ti ) 操作为 a = b + ( (a + G(b,c,d) + Mj + ti) &lt;&lt; s)</div>
<div class="para" label-module="para">HH(a ,b ,c ,d ,Mj ,s ,ti) 操作为 a = b + ( (a + H(b,c,d) + Mj + ti) &lt;&lt; s)</div>
<div class="para" label-module="para">II(a ,b ,c ,d ,Mj ,s ,ti) 操作为 a = b + ( (a + I(b,c,d) + Mj + ti) &lt;&lt; s)</div>
<div class="para" label-module="para"><b>注意：“&lt;&lt;”表示循环左移位，不是左移位。</b></div>
<div class="para" label-module="para">这四轮（共64步）是：</div>
<div class="para" label-module="para">第一轮</div>
<div class="para" label-module="para">FF(a ,b ,c ,d ,M0 ,7 ,0xd76aa478 )</div>
<div class="para" label-module="para">FF(d ,a ,b ,c ,M1 ,12 ,0xe8c7b756 )</div>
<div class="para" label-module="para">FF(c ,d ,a ,b ,M2 ,17 ,0x242070db )</div>
<div class="para" label-module="para">FF(b ,c ,d ,a ,M3 ,22 ,0xc1bdceee )</div>
<div class="para" label-module="para">FF(a ,b ,c ,d ,M4 ,7 ,0xf57c0faf )</div>
<div class="para" label-module="para">FF(d ,a ,b ,c ,M5 ,12 ,0x4787c62a )</div>
<div class="para" label-module="para">FF(c ,d ,a ,b ,M6 ,17 ,0xa8304613 )</div>
<div class="para" label-module="para">FF(b ,c ,d ,a ,M7 ,22 ,0xfd469501)</div>
<div class="para" label-module="para">FF(a ,b ,c ,d ,M8 ,7 ,0x698098d8 )</div>
<div class="para" label-module="para">FF(d ,a ,b ,c ,M9 ,12 ,0x8b44f7af )</div>
<div class="para" label-module="para">FF(c ,d ,a ,b ,M10 ,17 ,0xffff5bb1 )</div>
<div class="para" label-module="para">FF(b ,c ,d ,a ,M11 ,22 ,0x895cd7be )</div>
<div class="para" label-module="para">FF(a ,b ,c ,d ,M12 ,7 ,0x6b901122 )</div>
<div class="para" label-module="para">FF(d ,a ,b ,c ,M13 ,12 ,0xfd987193 )</div>
<div class="para" label-module="para">FF(c ,d ,a ,b ,M14 ,17 ,0xa679438e )</div>
<div class="para" label-module="para">FF(b ,c ,d ,a ,M15 ,22 ,0x49b40821 )</div>
<div class="para" label-module="para">第二轮</div>
<div class="para" label-module="para">GG(a ,b ,c ,d ,M1 ,5 ,0xf61e2562 )</div>
<div class="para" label-module="para">GG(d ,a ,b ,c ,M6 ,9 ,0xc040b340 )</div>
<div class="para" label-module="para">GG(c ,d ,a ,b ,M11 ,14 ,0x265e5a51 )</div>
<div class="para" label-module="para">GG(b ,c ,d ,a ,M0 ,20 ,0xe9b6c7aa )</div>
<div class="para" label-module="para">GG(a ,b ,c ,d ,M5 ,5 ,0xd62f105d )</div>
<div class="para" label-module="para">GG(d ,a ,b ,c ,M10 ,9 ,0x02441453 )</div>
<div class="para" label-module="para">GG(c ,d ,a ,b ,M15 ,14 ,0xd8a1e681 )</div>
<div class="para" label-module="para">GG(b ,c ,d ,a ,M4 ,20 ,0xe7d3fbc8 )</div>
<div class="para" label-module="para">GG(a ,b ,c ,d ,M9 ,5 ,0x21e1cde6 )</div>
<div class="para" label-module="para">GG(d ,a ,b ,c ,M14 ,9 ,0xc33707d6 )</div>
<div class="para" label-module="para">GG(c ,d ,a ,b ,M3 ,14 ,0xf4d50d87 )</div>
<div class="para" label-module="para">GG(b ,c ,d ,a ,M8 ,20 ,0x455a14ed )</div>
<div class="para" label-module="para">GG(a ,b ,c ,d ,M13 ,5 ,0xa9e3e905 )</div>
<div class="para" label-module="para">GG(d ,a ,b ,c ,M2 ,9 ,0xfcefa3f8 )</div>
<div class="para" label-module="para">GG(c ,d ,a ,b ,M7 ,14 ,0x676f02d9 )</div>
<div class="para" label-module="para">GG(b ,c ,d ,a ,M12 ,20 ,0x8d2a4c8a )</div>
<div class="para" label-module="para">第三轮</div>
<div class="para" label-module="para">HH(a ,b ,c ,d ,M5 ,4 ,0xfffa3942 )</div>
<div class="para" label-module="para">HH(d ,a ,b ,c ,M8 ,11 ,0x8771f681 )</div>
<div class="para" label-module="para">HH(c ,d ,a ,b ,M11 ,16 ,0x6d9d6122 )</div>
<div class="para" label-module="para">HH(b ,c ,d ,a ,M14 ,23 ,0xfde5380c )</div>
<div class="para" label-module="para">HH(a ,b ,c ,d ,M1 ,4 ,0xa4beea44 )</div>
<div class="para" label-module="para">HH(d ,a ,b ,c ,M4 ,11 ,0x4bdecfa9 )</div>
<div class="para" label-module="para">HH(c ,d ,a ,b ,M7 ,16 ,0xf6bb4b60 )</div>
<div class="para" label-module="para">HH(b ,c ,d ,a ,M10 ,23 ,0xbebfbc70 )</div>
<div class="para" label-module="para">HH(a ,b ,c ,d ,M13 ,4 ,0x289b7ec6 )</div>
<div class="para" label-module="para">HH(d ,a ,b ,c ,M0 ,11 ,0xeaa127fa )</div>
<div class="para" label-module="para">HH(c ,d ,a ,b ,M3 ,16 ,0xd4ef3085 )</div>
<div class="para" label-module="para">HH(b ,c ,d ,a ,M6 ,23 ,0x04881d05 )</div>
<div class="para" label-module="para">HH(a ,b ,c ,d ,M9 ,4 ,0xd9d4d039 )</div>
<div class="para" label-module="para">HH(d ,a ,b ,c ,M12 ,11 ,0xe6db99e5 )</div>
<div class="para" label-module="para">HH(c ,d ,a ,b ,M15 ,16 ,0x1fa27cf8 )</div>
<div class="para" label-module="para">HH(b ,c ,d ,a ,M2 ,23 ,0xc4ac5665 )</div>
<div class="para" label-module="para">第四轮</div>
<div class="para" label-module="para">II(a ,b ,c ,d ,M0 ,6 ,0xf4292244 )</div>
<div class="para" label-module="para">II(d ,a ,b ,c ,M7 ,10 ,0x432aff97 )</div>
<div class="para" label-module="para">II(c ,d ,a ,b ,M14 ,15 ,0xab9423a7 )</div>
<div class="para" label-module="para">II(b ,c ,d ,a ,M5 ,21 ,0xfc93a039 )</div>
<div class="para" label-module="para">II(a ,b ,c ,d ,M12 ,6 ,0x655b59c3 )</div>
<div class="para" label-module="para">II(d ,a ,b ,c ,M3 ,10 ,0x8f0ccc92 )</div>
<div class="para" label-module="para">II(c ,d ,a ,b ,M10 ,15 ,0xffeff47d )</div>
<div class="para" label-module="para">II(b ,c ,d ,a ,M1 ,21 ,0x85845dd1 )</div>
<div class="para" label-module="para">II(a ,b ,c ,d ,M8 ,6 ,0x6fa87e4f )</div>
<div class="para" label-module="para">II(d ,a ,b ,c ,M15 ,10 ,0xfe2ce6e0 )</div>
<div class="para" label-module="para">II(c ,d ,a ,b ,M6 ,15 ,0xa3014314 )</div>
<div class="para" label-module="para">II(b ,c ,d ,a ,M13 ,21 ,0x4e0811a1 )</div>
<div class="para" label-module="para">II(a ,b ,c ,d ,M4 ,6 ,0xf7537e82 )</div>
<div class="para" label-module="para">II(d ,a ,b ,c ,M11 ,10 ,0xbd3af235 )</div>
<div class="para" label-module="para">II(c ,d ,a ,b ,M2 ,15 ,0x2ad7d2bb )</div>
<div class="para" label-module="para">II(b ,c ,d ,a ,M9 ,21 ,0xeb86d391 )</div>
<div class="para" label-module="para">所有这些完成之后，将a、b、c、d分别在原来基础上再加上A、B、C、D。</div>
<div class="para" label-module="para">即a = a + A，b = b + B，c = c + C，d = d + D</div>
<div class="para" label-module="para">然后用下一分组数据继续运行以上算法。</div>
<div class="para" label-module="para"><b>4. 输出</b></div>
<div class="para" label-module="para">最后的输出是a、b、c和d的级联。</div>
<div class="para" label-module="para">当你按照我上面所说的方法实现MD5算法以后，你可以用以下几个信息对你做出来的程序作一个简单的测试，看看程序有没有错误。</div>
<div class="para" label-module="para">MD5 (&quot;&quot;) = d41d8cd98f00b204e9800998ecf8427e</div>
<div class="para" label-module="para">MD5 (&quot;a&quot;) = 0cc175b9c0f1b6a831c399e269772661</div>
<div class="para" label-module="para">MD5 (&quot;abc&quot;) = 900150983cd24fb0d6963f7d28e17f72</div>
<div class="para" label-module="para">MD5 (&quot;message digest&quot;) = f96b697d7cb7938d525a2f31aaf161d0</div>
<div class="para" label-module="para">MD5 (&quot;abcdefghijklmnopqrstuvwxyz&quot;) = c3fcd3d76192e4007dfb496cca67e13b</div>
<div class="para" label-module="para">MD5 (&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;) =</div>
<div class="para" label-module="para">f29939a25efabaef3b87e2cbfe641315</div>
<div class="para" label-module="para">MD5 (&quot;8a683566bcc7801226b3d8b0cf35fd97&quot;) =cf2cb5c89c5e5eeebef4a76becddfcfd</div><div class="anchor-list">
<a name="3_2" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_2" class="lemma-anchor " ></a>
<a name="MD5加密字符串实例" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>MD5加密字符串实例</h3>
</div>
<div class="para" label-module="para">现以字符串“jklmn”为例。</div>
<div class="para" label-module="para">该字符串在内存中表示为：6A 6B 6C 6D 6E（从左到右为低地址到高地址，后同），信息长度为40 bits， 即0x28。</div>
<div class="para" label-module="para">对其填充，填充至448位，即56字节。结果为：</div>
<div class="para" label-module="para">6A 6B 6C 6D 6E 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</div>
<div class="para" label-module="para">剩下64位，即8字节填充填充前信息位长，按小端字节序填充剩下的8字节，结果为。</div>
<div class="para" label-module="para">6A 6B 6C 6D 6E 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 00 00 00 00 00 00 00</div>
<div class="para" label-module="para">（64字节，512 bits）</div>
<div class="para" label-module="para">初始化A、B、C、D四个变量。</div>
<div class="para" label-module="para">将这64字节填充后数据分成16个小组（程序中对应为16个数组），即：</div>
<div class="para" label-module="para">M0：6A 6B 6C 6D （这是内存中的顺序，按照小端字节序原则，对应数组M(0)的值为0x6D6C6B6A，下同）</div>
<div class="para" label-module="para">M1：6E 80 00 00</div>
<div class="para" label-module="para">M2：00 00 00 00</div>
<div class="para" label-module="para">.....</div>
<div class="para" label-module="para">M14：28 00 00 00</div>
<div class="para" label-module="para">M15：00 00 00 00</div>
<div class="para" label-module="para">经过“<b>3. 分组数据处理</b>”后，a、b、c、d值分别为0xD8523F60、0x837E0144、0x517726CA、0x1BB6E5FE</div>
<div class="para" label-module="para">在内存中为a：60 3F 52 D8</div>
<div class="para" label-module="para">b：44 01 7E 83</div>
<div class="para" label-module="para">c：CA 26 77 51</div>
<div class="para" label-module="para">d：FE E5 B6 1B</div>
<div class="para" label-module="para">a、b、c、d按内存顺序输出即为最终结果：603F52D844017E83CA267751FEE5B61B。这就是字符串“jklmn”的MD5值。</div><div class="anchor-list">
<a name="3_3" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_3" class="lemma-anchor " ></a>
<a name="C++实现" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>C++实现</h3>
</div>
<pre class="brush: cpp">#include&lt;iostream&gt;
#include&lt;string&gt;
using&nbsp;namespace&nbsp;std;
#define&nbsp;shift(x,&nbsp;n)&nbsp;(((x)&nbsp;&lt;&lt;&nbsp;(n))&nbsp;|&nbsp;((x)&nbsp;&gt;&gt;&nbsp;(32-(n))))//右移的时候，高位一定要补零，而不是补充符号位
#define&nbsp;F(x,&nbsp;y,&nbsp;z)&nbsp;(((x)&nbsp;&amp;&nbsp;(y))&nbsp;|&nbsp;((~x)&nbsp;&amp;&nbsp;(z)))&nbsp;&nbsp;&nbsp;&nbsp;
#define&nbsp;G(x,&nbsp;y,&nbsp;z)&nbsp;(((x)&nbsp;&amp;&nbsp;(z))&nbsp;|&nbsp;((y)&nbsp;&amp;&nbsp;(~z)))
#define&nbsp;H(x,&nbsp;y,&nbsp;z)&nbsp;((x)&nbsp;^&nbsp;(y)&nbsp;^&nbsp;(z))
#define&nbsp;I(x,&nbsp;y,&nbsp;z)&nbsp;((y)&nbsp;^&nbsp;((x)&nbsp;|&nbsp;(~z)))
#define&nbsp;A&nbsp;0x67452301
#define&nbsp;B&nbsp;0xefcdab89
#define&nbsp;C&nbsp;0x98badcfe
#define&nbsp;D&nbsp;0x10325476
//strBaye的长度
unsigned&nbsp;int&nbsp;strlength;
//A,B,C,D的临时变量
unsigned&nbsp;int&nbsp;atemp;
unsigned&nbsp;int&nbsp;btemp;
unsigned&nbsp;int&nbsp;ctemp;
unsigned&nbsp;int&nbsp;dtemp;
//常量ti&nbsp;unsigned&nbsp;int(abs(sin(i+1))*(2pow32))
const&nbsp;unsigned&nbsp;int&nbsp;k[]={
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xd76aa478,0xe8c7b756,0x242070db,0xc1bdceee,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf57c0faf,0x4787c62a,0xa8304613,0xfd469501,0x698098d8,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8b44f7af,0xffff5bb1,0x895cd7be,0x6b901122,0xfd987193,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xa679438e,0x49b40821,0xf61e2562,0xc040b340,0x265e5a51,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xe9b6c7aa,0xd62f105d,0x02441453,0xd8a1e681,0xe7d3fbc8,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x21e1cde6,0xc33707d6,0xf4d50d87,0x455a14ed,0xa9e3e905,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xfcefa3f8,0x676f02d9,0x8d2a4c8a,0xfffa3942,0x8771f681,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x6d9d6122,0xfde5380c,0xa4beea44,0x4bdecfa9,0xf6bb4b60,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbebfbc70,0x289b7ec6,0xeaa127fa,0xd4ef3085,0x04881d05,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xd9d4d039,0xe6db99e5,0x1fa27cf8,0xc4ac5665,0xf4292244,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x432aff97,0xab9423a7,0xfc93a039,0x655b59c3,0x8f0ccc92,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xffeff47d,0x85845dd1,0x6fa87e4f,0xfe2ce6e0,0xa3014314,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x4e0811a1,0xf7537e82,0xbd3af235,0x2ad7d2bb,0xeb86d391};
//向左位移数
const&nbsp;unsigned&nbsp;int&nbsp;s[]={7,12,17,22,7,12,17,22,7,12,17,22,7,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15,21,6,10,15,21,6,10,15,21,6,10,15,21};
const&nbsp;char&nbsp;str16[]=&quot;0123456789abcdef&quot;;
void&nbsp;mainLoop(unsigned&nbsp;int&nbsp;M[])
{
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;f,g;
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;a=atemp;
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;b=btemp;
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;c=ctemp;
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;d=dtemp;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(unsigned&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;64;&nbsp;i++)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i&lt;16){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=F(b,c,d);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if&nbsp;(i&lt;32)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=G(b,c,d);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(5*i+1)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if(i&lt;48){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=H(b,c,d);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(3*i+5)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f=I(b,c,d);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(7*i)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;tmp=d;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=b;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=b+shift((a+f+k[i]+M[g]),s[i]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a=tmp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;atemp=a+atemp;
&nbsp;&nbsp;&nbsp;&nbsp;btemp=b+btemp;
&nbsp;&nbsp;&nbsp;&nbsp;ctemp=c+ctemp;
&nbsp;&nbsp;&nbsp;&nbsp;dtemp=d+dtemp;
}
/*
*填充函数
*处理后应满足bits≡448(mod512),字节就是bytes≡56（mode64)
*填充方式为先加一个1,其它位补零
*最后加上64位的原来长度
*/
unsigned&nbsp;int*&nbsp;add(string&nbsp;str)
{
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;num=((str.length()+8)/64)+1;//以512位,64个字节为一组
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;*strByte=new&nbsp;unsigned&nbsp;int[num*16];&nbsp;&nbsp;&nbsp;&nbsp;//64/4=16,所以有16个整数
&nbsp;&nbsp;&nbsp;&nbsp;strlength=num*16;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(unsigned&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;num*16;&nbsp;i++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[i]=0;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(unsigned&nbsp;int&nbsp;i=0;&nbsp;i&nbsp;&lt;str.length();&nbsp;i++)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[i&gt;&gt;2]|=(str[i])&lt;&lt;((i%4)*8);//一个整数存储四个字节，i&gt;&gt;2表示i/4&nbsp;一个unsigned&nbsp;int对应4个字节，保存4个字符信息
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;strByte[str.length()&gt;&gt;2]|=0x80&lt;&lt;(((str.length()%4))*8);//尾部添加1&nbsp;一个unsigned&nbsp;int保存4个字符信息,所以用128左移
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*添加原长度，长度指位的长度，所以要乘8，然后是小端序，所以放在倒数第二个,这里长度只用了32位
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;strByte[num*16-2]=str.length()*8;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;strByte;
}
string&nbsp;changeHex(int&nbsp;a)
{
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;b;
&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;str1;
&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;str=&quot;&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;4;i++)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str1=&quot;&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=((a&gt;&gt;i*8)%(1&lt;&lt;8))&amp;0xff;&nbsp;&nbsp;&nbsp;//逆序处理每个字节
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;2;&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str1.insert(0,1,str16[b%16]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=b/16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=str1;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;str;
}
string&nbsp;getMD5(string&nbsp;source)
{
&nbsp;&nbsp;&nbsp;&nbsp;atemp=A;&nbsp;&nbsp;&nbsp;&nbsp;//初始化
&nbsp;&nbsp;&nbsp;&nbsp;btemp=B;
&nbsp;&nbsp;&nbsp;&nbsp;ctemp=C;
&nbsp;&nbsp;&nbsp;&nbsp;dtemp=D;
&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;*strByte=add(source);
&nbsp;&nbsp;&nbsp;&nbsp;for(unsigned&nbsp;int&nbsp;i=0;i&lt;strlength/16;i++)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;num[16];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(unsigned&nbsp;int&nbsp;j=0;j&lt;16;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[j]=strByte[i*16+j];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mainLoop(num);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;changeHex(atemp).append(changeHex(btemp)).append(changeHex(ctemp)).append(changeHex(dtemp));
}
unsigned&nbsp;int&nbsp;main()
{
&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;ss;
//&nbsp;&nbsp;&nbsp;&nbsp;cin&gt;&gt;ss;
&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;s=getMD5(&quot;abc&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;s;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
}

</pre><div class="anchor-list">
<a name="3_4" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_4" class="lemma-anchor " ></a>
<a name="JAVA实现" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>JAVA实现</h3>
</div>
<div class="para" label-module="para">参考</div>
<pre class="brush: java">public&nbsp;class&nbsp;MD5{
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*四个链接变量
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;A=0x67452301;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;B=0xefcdab89;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;C=0x98badcfe;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;D=0x10325476;
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*ABCD的临时变量
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int&nbsp;Atemp,Btemp,Ctemp,Dtemp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*常量ti
&nbsp;&nbsp;&nbsp;&nbsp;*公式:floor(abs(sin(i+1))×(2pow32)
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;K[]={
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xd76aa478,0xe8c7b756,0x242070db,0xc1bdceee,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf57c0faf,0x4787c62a,0xa8304613,0xfd469501,0x698098d8,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x8b44f7af,0xffff5bb1,0x895cd7be,0x6b901122,0xfd987193,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xa679438e,0x49b40821,0xf61e2562,0xc040b340,0x265e5a51,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xe9b6c7aa,0xd62f105d,0x02441453,0xd8a1e681,0xe7d3fbc8,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x21e1cde6,0xc33707d6,0xf4d50d87,0x455a14ed,0xa9e3e905,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xfcefa3f8,0x676f02d9,0x8d2a4c8a,0xfffa3942,0x8771f681,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x6d9d6122,0xfde5380c,0xa4beea44,0x4bdecfa9,0xf6bb4b60,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xbebfbc70,0x289b7ec6,0xeaa127fa,0xd4ef3085,0x04881d05,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xd9d4d039,0xe6db99e5,0x1fa27cf8,0xc4ac5665,0xf4292244,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x432aff97,0xab9423a7,0xfc93a039,0x655b59c3,0x8f0ccc92,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xffeff47d,0x85845dd1,0x6fa87e4f,0xfe2ce6e0,0xa3014314,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x4e0811a1,0xf7537e82,0xbd3af235,0x2ad7d2bb,0xeb86d391};
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*向左位移数,计算方法未知
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;final&nbsp;int&nbsp;s[]={7,12,17,22,7,12,17,22,7,12,17,22,7,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15,21,6,10,15,21,6,10,15,21,6,10,15,21};
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*初始化函数
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;init(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Atemp=A;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Btemp=B;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ctemp=C;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dtemp=D;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*移动一定位数
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;shift(int&nbsp;a,int&nbsp;s){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(a&lt;&lt;s)|(a&gt;&gt;&gt;(32-s));//右移的时候，高位一定要补零，而不是补充符号位
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*主循环
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;void&nbsp;MainLoop(int&nbsp;M[]){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;F,g;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;a=Atemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;b=Btemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;c=Ctemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;d=Dtemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;64;&nbsp;i&nbsp;++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i&lt;16){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=(b&amp;c)|((~b)&amp;d);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if(i&lt;32){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=(d&amp;b)|((~d)&amp;c);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(5*i+1)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if(i&lt;48){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=b^c^d;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(3*i+5)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=c^(b|(~d));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g=(7*i)%16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tmp=d;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=b;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b=b+shift(a+F+K[i]+M[g],s[i]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a=tmp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Atemp=a+Atemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Btemp=b+Btemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ctemp=c+Ctemp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dtemp=d+Dtemp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*填充函数
&nbsp;&nbsp;&nbsp;&nbsp;*处理后应满足bits≡448(mod512),字节就是bytes≡56（mode64)
&nbsp;&nbsp;&nbsp;&nbsp;*填充方式为先加一个0,其它位补零
&nbsp;&nbsp;&nbsp;&nbsp;*最后加上64位的原来长度
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;int[]&nbsp;add(String&nbsp;str){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;num=((str.length()+8)/64)+1;//以512位，64个字节为一组
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;strByte[]=new&nbsp;int[num*16];//64/4=16，所以有16个整数
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;num*16;i++){//全部初始化0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[i]=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(i=0;i&lt;str.length();i++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[i&gt;&gt;2]|=str.charAt(i)&lt;&lt;((i%4)*8);//一个整数存储四个字节，小端序
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[i&gt;&gt;2]|=0x80&lt;&lt;((i%4)*8);//尾部添加1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*添加原长度，长度指位的长度，所以要乘8，然后是小端序，所以放在倒数第二个,这里长度只用了32位
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strByte[num*16-2]=str.length()*8;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;strByte;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*调用函数
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getMD5(String&nbsp;source){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;strByte[]=add(source);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;strByte.length/16;i++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;num[]=new&nbsp;int[16];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=0;j&lt;16;j++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[j]=strByte[i*16+j];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MainLoop(num);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;changeHex(Atemp)+changeHex(Btemp)+changeHex(Ctemp)+changeHex(Dtemp);
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*整数变成16进制字符串
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;changeHex(int&nbsp;a){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;str=&quot;&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;4;i++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str+=String.format(&quot;%2s&quot;,&nbsp;Integer.toHexString(((a&gt;&gt;i*8)%(1&lt;&lt;8))&amp;0xff)).replace(&#39;&nbsp;&#39;,&nbsp;&#39;0&#39;);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;str;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;/*
&nbsp;&nbsp;&nbsp;&nbsp;*单例
&nbsp;&nbsp;&nbsp;&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;static&nbsp;MD5&nbsp;instance;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;MD5&nbsp;getInstance(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(instance==null){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instance=new&nbsp;MD5();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;instance;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;MD5(){};
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(String[]&nbsp;args){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;str=MD5.getInstance().getMD5(&quot;&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(str);
&nbsp;&nbsp;&nbsp;&nbsp;}
}

</pre><pre class="brush: java">
</pre><div class="anchor-list">
<a name="3_5" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_5" class="lemma-anchor " ></a>
<a name="VB2010实现" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>VB2010实现</h3>
</div>
<pre class="brush: vb">Imports&nbsp;System

Imports&nbsp;System.Security.Cryptography

Imports&nbsp;System.Text


Module&nbsp;Example
&nbsp;&nbsp;&nbsp;&nbsp;&#39;哈希输入字符串并返回一个&nbsp;32&nbsp;字符的十六进制字符串哈希。

&nbsp;&nbsp;&nbsp;&nbsp;Function&nbsp;GetMd5Hash(ByVal&nbsp;input&nbsp;As&nbsp;String)&nbsp;As&nbsp;String

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;创建新的一个&nbsp;MD5CryptoServiceProvider&nbsp;对象的实例。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;md5Hasher&nbsp;As&nbsp;New&nbsp;MD5CryptoServiceProvider()

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;输入的字符串转换为字节数组，并计算哈希。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;data&nbsp;As&nbsp;Byte()&nbsp;=&nbsp;md5Hasher.ComputeHash(Encoding.Default.GetBytes(input))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;创建一个新的&nbsp;StringBuilder&nbsp;收集的字节，并创建一个字符串。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;sBuilder&nbsp;As&nbsp;New&nbsp;StringBuilder()

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;通过每个字节的哈希数据和格式为十六进制字符串的每一个循环。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;As&nbsp;Integer&nbsp;=&nbsp;0&nbsp;To&nbsp;data.Length&nbsp;-&nbsp;1

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sBuilder.Append(data(i).ToString(&quot;x2&quot;))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;返回十六进制字符串。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;sBuilder.ToString()

&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Function


&nbsp;&nbsp;&nbsp;&nbsp;&#39;验证对一个字符串的哈希值。

&nbsp;&nbsp;&nbsp;&nbsp;Function&nbsp;VerifyMd5Hash(ByVal&nbsp;input&nbsp;As&nbsp;String,&nbsp;ByVal&nbsp;hash&nbsp;As&nbsp;String)&nbsp;As&nbsp;Boolean

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;哈希的输入。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;hashOfInput&nbsp;As&nbsp;String&nbsp;=&nbsp;GetMd5Hash(input)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;创建&nbsp;StringComparer&nbsp;的哈希进行比较。

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;comparer&nbsp;As&nbsp;StringComparer&nbsp;=&nbsp;StringComparer.OrdinalIgnoreCase

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;comparer.Compare(hashOfInput,&nbsp;hash)&nbsp;=&nbsp;0

&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Function


&nbsp;&nbsp;&nbsp;&nbsp;Sub&nbsp;Main()

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;source&nbsp;As&nbsp;String&nbsp;=&nbsp;&quot;Hello&nbsp;World!&quot;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;hash&nbsp;As&nbsp;String&nbsp;=&nbsp;GetMd5Hash(source)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine($&quot;进行MD5加密的字符串为：{source}，加密的结果是：{hash}。&quot;)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(&quot;正在验证哈希……&quot;)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;VerifyMd5Hash(source,&nbsp;hash)&nbsp;Then

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(&quot;哈希值是
相同的。&quot;)

Else

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(&quot;哈希值是不相同的。&quot;)

EndIf

&nbsp;&nbsp;&nbsp;&nbsp;EndSub

EndModule


&#39;此代码示例产生下面的输出：


&#39;进行MD5加密的字符串为：Hello&nbsp;World!，加密的结果是：ed076287532e86365e841e92bfc50d8c。

&#39;正在验证哈希……

&#39;哈希值是相同的。

</pre><div class="anchor-list">
<a name="3_6" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_6" class="lemma-anchor " ></a>
<a name="JavaScript实现" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>JavaScript实现</h3>
</div>
<pre class="brush: js">function&nbsp;md5(string)&nbsp;{
    function&nbsp;md5_RotateLeft(lValue,&nbsp;iShiftBits)&nbsp;{
        return&nbsp;(lValue&nbsp;&lt;&lt;&nbsp;iShiftBits)&nbsp;|&nbsp;(lValue&nbsp;&gt;&gt;&gt;&nbsp;(32&nbsp;-&nbsp;iShiftBits));
    }
    function&nbsp;md5_AddUnsigned(lX,&nbsp;lY)&nbsp;{
        var&nbsp;lX4,&nbsp;lY4,&nbsp;lX8,&nbsp;lY8,&nbsp;lResult;
        lX8&nbsp;=&nbsp;(lX&nbsp;&amp;&nbsp;0x80000000);
        lY8&nbsp;=&nbsp;(lY&nbsp;&amp;&nbsp;0x80000000);
        lX4&nbsp;=&nbsp;(lX&nbsp;&amp;&nbsp;0x40000000);
        lY4&nbsp;=&nbsp;(lY&nbsp;&amp;&nbsp;0x40000000);
        lResult&nbsp;=&nbsp;(lX&nbsp;&amp;&nbsp;0x3FFFFFFF)&nbsp;+&nbsp;(lY&nbsp;&amp;&nbsp;0x3FFFFFFF);
        if&nbsp;(lX4&nbsp;&amp;&nbsp;lY4)&nbsp;{
            return&nbsp;(lResult&nbsp;^&nbsp;0x80000000&nbsp;^&nbsp;lX8&nbsp;^&nbsp;lY8);
        }
        if&nbsp;(lX4&nbsp;|&nbsp;lY4)&nbsp;{
            if&nbsp;(lResult&nbsp;&amp;&nbsp;0x40000000)&nbsp;{
                return&nbsp;(lResult&nbsp;^&nbsp;0xC0000000&nbsp;^&nbsp;lX8&nbsp;^&nbsp;lY8);
            }&nbsp;else&nbsp;{
                return&nbsp;(lResult&nbsp;^&nbsp;0x40000000&nbsp;^&nbsp;lX8&nbsp;^&nbsp;lY8);
            }
        }&nbsp;else&nbsp;{
            return&nbsp;(lResult&nbsp;^&nbsp;lX8&nbsp;^&nbsp;lY8);
        }
    }
    function&nbsp;md5_F(x,&nbsp;y,&nbsp;z)&nbsp;{
        return&nbsp;(x&nbsp;&amp;&nbsp;y)&nbsp;|&nbsp;((~x)&nbsp;&amp;&nbsp;z);
    }
    function&nbsp;md5_G(x,&nbsp;y,&nbsp;z)&nbsp;{
        return&nbsp;(x&nbsp;&amp;&nbsp;z)&nbsp;|&nbsp;(y&nbsp;&amp;&nbsp;(~z));
    }
    function&nbsp;md5_H(x,&nbsp;y,&nbsp;z)&nbsp;{
        return&nbsp;(x&nbsp;^&nbsp;y&nbsp;^&nbsp;z);
    }
    function&nbsp;md5_I(x,&nbsp;y,&nbsp;z)&nbsp;{
        return&nbsp;(y&nbsp;^&nbsp;(x&nbsp;|&nbsp;(~z)));
    }
    function&nbsp;md5_FF(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x,&nbsp;s,&nbsp;ac)&nbsp;{
        a&nbsp;=&nbsp;md5_AddUnsigned(a,&nbsp;md5_AddUnsigned(md5_AddUnsigned(md5_F(b,&nbsp;c,&nbsp;d),&nbsp;x),&nbsp;ac));
        return&nbsp;md5_AddUnsigned(md5_RotateLeft(a,&nbsp;s),&nbsp;b);
    };
    function&nbsp;md5_GG(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x,&nbsp;s,&nbsp;ac)&nbsp;{
        a&nbsp;=&nbsp;md5_AddUnsigned(a,&nbsp;md5_AddUnsigned(md5_AddUnsigned(md5_G(b,&nbsp;c,&nbsp;d),&nbsp;x),&nbsp;ac));
        return&nbsp;md5_AddUnsigned(md5_RotateLeft(a,&nbsp;s),&nbsp;b);
    };
    function&nbsp;md5_HH(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x,&nbsp;s,&nbsp;ac)&nbsp;{
        a&nbsp;=&nbsp;md5_AddUnsigned(a,&nbsp;md5_AddUnsigned(md5_AddUnsigned(md5_H(b,&nbsp;c,&nbsp;d),&nbsp;x),&nbsp;ac));
        return&nbsp;md5_AddUnsigned(md5_RotateLeft(a,&nbsp;s),&nbsp;b);
    };
    function&nbsp;md5_II(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x,&nbsp;s,&nbsp;ac)&nbsp;{
        a&nbsp;=&nbsp;md5_AddUnsigned(a,&nbsp;md5_AddUnsigned(md5_AddUnsigned(md5_I(b,&nbsp;c,&nbsp;d),&nbsp;x),&nbsp;ac));
        return&nbsp;md5_AddUnsigned(md5_RotateLeft(a,&nbsp;s),&nbsp;b);
    };
    function&nbsp;md5_ConvertToWordArray(string)&nbsp;{
        var&nbsp;lWordCount;
        var&nbsp;lMessageLength&nbsp;=&nbsp;string.length;
        var&nbsp;lNumberOfWords_temp1&nbsp;=&nbsp;lMessageLength&nbsp;+&nbsp;8;
        var&nbsp;lNumberOfWords_temp2&nbsp;=&nbsp;(lNumberOfWords_temp1&nbsp;-&nbsp;(lNumberOfWords_temp1&nbsp;%&nbsp;64))&nbsp;/&nbsp;64;
        var&nbsp;lNumberOfWords&nbsp;=&nbsp;(lNumberOfWords_temp2&nbsp;+&nbsp;1)&nbsp;*&nbsp;16;
        var&nbsp;lWordArray&nbsp;=&nbsp;Array(lNumberOfWords&nbsp;-&nbsp;1);
        var&nbsp;lBytePosition&nbsp;=&nbsp;0;
        var&nbsp;lByteCount&nbsp;=&nbsp;0;
        while&nbsp;(lByteCount&nbsp;&lt;&nbsp;lMessageLength)&nbsp;{
            lWordCount&nbsp;=&nbsp;(lByteCount&nbsp;-&nbsp;(lByteCount&nbsp;%&nbsp;4))&nbsp;/&nbsp;4;
            lBytePosition&nbsp;=&nbsp;(lByteCount&nbsp;%&nbsp;4)&nbsp;*&nbsp;8;
            lWordArray[lWordCount]&nbsp;=&nbsp;(lWordArray[lWordCount]&nbsp;|&nbsp;(string.charCodeAt(lByteCount)&nbsp;&lt;&lt;&nbsp;lBytePosition));
            lByteCount++;
        }
        lWordCount&nbsp;=&nbsp;(lByteCount&nbsp;-&nbsp;(lByteCount&nbsp;%&nbsp;4))&nbsp;/&nbsp;4;
        lBytePosition&nbsp;=&nbsp;(lByteCount&nbsp;%&nbsp;4)&nbsp;*&nbsp;8;
        lWordArray[lWordCount]&nbsp;=&nbsp;lWordArray[lWordCount]&nbsp;|&nbsp;(0x80&nbsp;&lt;&lt;&nbsp;lBytePosition);
        lWordArray[lNumberOfWords&nbsp;-&nbsp;2]&nbsp;=&nbsp;lMessageLength&nbsp;&lt;&lt;&nbsp;3;
        lWordArray[lNumberOfWords&nbsp;-&nbsp;1]&nbsp;=&nbsp;lMessageLength&nbsp;&gt;&gt;&gt;&nbsp;29;
        return&nbsp;lWordArray;
    };
    function&nbsp;md5_WordToHex(lValue)&nbsp;{
        var&nbsp;WordToHexValue&nbsp;=&nbsp;&quot;&quot;,
        WordToHexValue_temp&nbsp;=&nbsp;&quot;&quot;,
        lByte,&nbsp;lCount;
        for&nbsp;(lCount&nbsp;=&nbsp;0;&nbsp;lCount&nbsp;&lt;=&nbsp;3;&nbsp;lCount++)&nbsp;{
            lByte&nbsp;=&nbsp;(lValue&nbsp;&gt;&gt;&gt;&nbsp;(lCount&nbsp;*&nbsp;8))&nbsp;&amp;&nbsp;255;
            WordToHexValue_temp&nbsp;=&nbsp;&quot;0&quot;&nbsp;+&nbsp;lByte.toString(16);
            WordToHexValue&nbsp;=&nbsp;WordToHexValue&nbsp;+&nbsp;WordToHexValue_temp.substr(WordToHexValue_temp.length&nbsp;-&nbsp;2,&nbsp;2);
        }
        return&nbsp;WordToHexValue;
    };
    function&nbsp;md5_Utf8Encode(string)&nbsp;{
        string&nbsp;=&nbsp;string.replace(/\r\n/g,&nbsp;&quot;\n&quot;);
        var&nbsp;utftext&nbsp;=&nbsp;&quot;&quot;;
        for&nbsp;(var&nbsp;n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&lt;&nbsp;string.length;&nbsp;n++)&nbsp;{
            var&nbsp;c&nbsp;=&nbsp;string.charCodeAt(n);
            if&nbsp;(c&nbsp;&lt;&nbsp;128)&nbsp;{
                utftext&nbsp;+=&nbsp;String.fromCharCode(c);
            }&nbsp;else&nbsp;if&nbsp;((c&nbsp;&gt;&nbsp;127)&nbsp;&amp;&amp;&nbsp;(c&nbsp;&lt;&nbsp;2048))&nbsp;{
                utftext&nbsp;+=&nbsp;String.fromCharCode((c&nbsp;&gt;&gt;&nbsp;6)&nbsp;|&nbsp;192);
                utftext&nbsp;+=&nbsp;String.fromCharCode((c&nbsp;&amp;&nbsp;63)&nbsp;|&nbsp;128);
            }&nbsp;else&nbsp;{
                utftext&nbsp;+=&nbsp;String.fromCharCode((c&nbsp;&gt;&gt;&nbsp;12)&nbsp;|&nbsp;224);
                utftext&nbsp;+=&nbsp;String.fromCharCode(((c&nbsp;&gt;&gt;&nbsp;6)&nbsp;&amp;&nbsp;63)&nbsp;|&nbsp;128);
                utftext&nbsp;+=&nbsp;String.fromCharCode((c&nbsp;&amp;&nbsp;63)&nbsp;|&nbsp;128);
            }
        }
        return&nbsp;utftext;
    };
    var&nbsp;x&nbsp;=&nbsp;Array();
    var&nbsp;k,&nbsp;AA,&nbsp;BB,&nbsp;CC,&nbsp;DD,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;d;
    var&nbsp;S11&nbsp;=&nbsp;7,
    S12&nbsp;=&nbsp;12,
    S13&nbsp;=&nbsp;17,
    S14&nbsp;=&nbsp;22;
    var&nbsp;S21&nbsp;=&nbsp;5,
    S22&nbsp;=&nbsp;9,
    S23&nbsp;=&nbsp;14,
    S24&nbsp;=&nbsp;20;
    var&nbsp;S31&nbsp;=&nbsp;4,
    S32&nbsp;=&nbsp;11,
    S33&nbsp;=&nbsp;16,
    S34&nbsp;=&nbsp;23;
    var&nbsp;S41&nbsp;=&nbsp;6,
    S42&nbsp;=&nbsp;10,
    S43&nbsp;=&nbsp;15,
    S44&nbsp;=&nbsp;21;
    string&nbsp;=&nbsp;md5_Utf8Encode(string);
    x&nbsp;=&nbsp;md5_ConvertToWordArray(string);
    a&nbsp;=&nbsp;0x67452301;
    b&nbsp;=&nbsp;0xEFCDAB89;
    c&nbsp;=&nbsp;0x98BADCFE;
    d&nbsp;=&nbsp;0x10325476;
    for&nbsp;(k&nbsp;=&nbsp;0;&nbsp;k&nbsp;&lt;&nbsp;x.length;&nbsp;k&nbsp;+=&nbsp;16)&nbsp;{
        AA&nbsp;=&nbsp;a;
        BB&nbsp;=&nbsp;b;
        CC&nbsp;=&nbsp;c;
        DD&nbsp;=&nbsp;d;
        a&nbsp;=&nbsp;md5_FF(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;0],&nbsp;S11,&nbsp;0xD76AA478);
        d&nbsp;=&nbsp;md5_FF(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;1],&nbsp;S12,&nbsp;0xE8C7B756);
        c&nbsp;=&nbsp;md5_FF(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;2],&nbsp;S13,&nbsp;0x242070DB);
        b&nbsp;=&nbsp;md5_FF(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;3],&nbsp;S14,&nbsp;0xC1BDCEEE);
        a&nbsp;=&nbsp;md5_FF(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;4],&nbsp;S11,&nbsp;0xF57C0FAF);
        d&nbsp;=&nbsp;md5_FF(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;5],&nbsp;S12,&nbsp;0x4787C62A);
        c&nbsp;=&nbsp;md5_FF(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;6],&nbsp;S13,&nbsp;0xA8304613);
        b&nbsp;=&nbsp;md5_FF(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;7],&nbsp;S14,&nbsp;0xFD469501);
        a&nbsp;=&nbsp;md5_FF(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;8],&nbsp;S11,&nbsp;0x698098D8);
        d&nbsp;=&nbsp;md5_FF(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;9],&nbsp;S12,&nbsp;0x8B44F7AF);
        c&nbsp;=&nbsp;md5_FF(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;10],&nbsp;S13,&nbsp;0xFFFF5BB1);
        b&nbsp;=&nbsp;md5_FF(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;11],&nbsp;S14,&nbsp;0x895CD7BE);
        a&nbsp;=&nbsp;md5_FF(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;12],&nbsp;S11,&nbsp;0x6B901122);
        d&nbsp;=&nbsp;md5_FF(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;13],&nbsp;S12,&nbsp;0xFD987193);
        c&nbsp;=&nbsp;md5_FF(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;14],&nbsp;S13,&nbsp;0xA679438E);
        b&nbsp;=&nbsp;md5_FF(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;15],&nbsp;S14,&nbsp;0x49B40821);
        a&nbsp;=&nbsp;md5_GG(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;1],&nbsp;S21,&nbsp;0xF61E2562);
        d&nbsp;=&nbsp;md5_GG(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;6],&nbsp;S22,&nbsp;0xC040B340);
        c&nbsp;=&nbsp;md5_GG(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;11],&nbsp;S23,&nbsp;0x265E5A51);
        b&nbsp;=&nbsp;md5_GG(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;0],&nbsp;S24,&nbsp;0xE9B6C7AA);
        a&nbsp;=&nbsp;md5_GG(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;5],&nbsp;S21,&nbsp;0xD62F105D);
        d&nbsp;=&nbsp;md5_GG(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;10],&nbsp;S22,&nbsp;0x2441453);
        c&nbsp;=&nbsp;md5_GG(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;15],&nbsp;S23,&nbsp;0xD8A1E681);
        b&nbsp;=&nbsp;md5_GG(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;4],&nbsp;S24,&nbsp;0xE7D3FBC8);
        a&nbsp;=&nbsp;md5_GG(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;9],&nbsp;S21,&nbsp;0x21E1CDE6);
        d&nbsp;=&nbsp;md5_GG(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;14],&nbsp;S22,&nbsp;0xC33707D6);
        c&nbsp;=&nbsp;md5_GG(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;3],&nbsp;S23,&nbsp;0xF4D50D87);
        b&nbsp;=&nbsp;md5_GG(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;8],&nbsp;S24,&nbsp;0x455A14ED);
        a&nbsp;=&nbsp;md5_GG(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;13],&nbsp;S21,&nbsp;0xA9E3E905);
        d&nbsp;=&nbsp;md5_GG(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;2],&nbsp;S22,&nbsp;0xFCEFA3F8);
        c&nbsp;=&nbsp;md5_GG(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;7],&nbsp;S23,&nbsp;0x676F02D9);
        b&nbsp;=&nbsp;md5_GG(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;12],&nbsp;S24,&nbsp;0x8D2A4C8A);
        a&nbsp;=&nbsp;md5_HH(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;5],&nbsp;S31,&nbsp;0xFFFA3942);
        d&nbsp;=&nbsp;md5_HH(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;8],&nbsp;S32,&nbsp;0x8771F681);
        c&nbsp;=&nbsp;md5_HH(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;11],&nbsp;S33,&nbsp;0x6D9D6122);
        b&nbsp;=&nbsp;md5_HH(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;14],&nbsp;S34,&nbsp;0xFDE5380C);
        a&nbsp;=&nbsp;md5_HH(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;1],&nbsp;S31,&nbsp;0xA4BEEA44);
        d&nbsp;=&nbsp;md5_HH(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;4],&nbsp;S32,&nbsp;0x4BDECFA9);
        c&nbsp;=&nbsp;md5_HH(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;7],&nbsp;S33,&nbsp;0xF6BB4B60);
        b&nbsp;=&nbsp;md5_HH(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;10],&nbsp;S34,&nbsp;0xBEBFBC70);
        a&nbsp;=&nbsp;md5_HH(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;13],&nbsp;S31,&nbsp;0x289B7EC6);
        d&nbsp;=&nbsp;md5_HH(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;0],&nbsp;S32,&nbsp;0xEAA127FA);
        c&nbsp;=&nbsp;md5_HH(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;3],&nbsp;S33,&nbsp;0xD4EF3085);
        b&nbsp;=&nbsp;md5_HH(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;6],&nbsp;S34,&nbsp;0x4881D05);
        a&nbsp;=&nbsp;md5_HH(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;9],&nbsp;S31,&nbsp;0xD9D4D039);
        d&nbsp;=&nbsp;md5_HH(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;12],&nbsp;S32,&nbsp;0xE6DB99E5);
        c&nbsp;=&nbsp;md5_HH(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;15],&nbsp;S33,&nbsp;0x1FA27CF8);
        b&nbsp;=&nbsp;md5_HH(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;2],&nbsp;S34,&nbsp;0xC4AC5665);
        a&nbsp;=&nbsp;md5_II(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;0],&nbsp;S41,&nbsp;0xF4292244);
        d&nbsp;=&nbsp;md5_II(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;7],&nbsp;S42,&nbsp;0x432AFF97);
        c&nbsp;=&nbsp;md5_II(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;14],&nbsp;S43,&nbsp;0xAB9423A7);
        b&nbsp;=&nbsp;md5_II(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;5],&nbsp;S44,&nbsp;0xFC93A039);
        a&nbsp;=&nbsp;md5_II(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;12],&nbsp;S41,&nbsp;0x655B59C3);
        d&nbsp;=&nbsp;md5_II(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;3],&nbsp;S42,&nbsp;0x8F0CCC92);
        c&nbsp;=&nbsp;md5_II(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;10],&nbsp;S43,&nbsp;0xFFEFF47D);
        b&nbsp;=&nbsp;md5_II(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;1],&nbsp;S44,&nbsp;0x85845DD1);
        a&nbsp;=&nbsp;md5_II(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;8],&nbsp;S41,&nbsp;0x6FA87E4F);
        d&nbsp;=&nbsp;md5_II(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;15],&nbsp;S42,&nbsp;0xFE2CE6E0);
        c&nbsp;=&nbsp;md5_II(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;6],&nbsp;S43,&nbsp;0xA3014314);
        b&nbsp;=&nbsp;md5_II(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;13],&nbsp;S44,&nbsp;0x4E0811A1);
        a&nbsp;=&nbsp;md5_II(a,&nbsp;b,&nbsp;c,&nbsp;d,&nbsp;x[k&nbsp;+&nbsp;4],&nbsp;S41,&nbsp;0xF7537E82);
        d&nbsp;=&nbsp;md5_II(d,&nbsp;a,&nbsp;b,&nbsp;c,&nbsp;x[k&nbsp;+&nbsp;11],&nbsp;S42,&nbsp;0xBD3AF235);
        c&nbsp;=&nbsp;md5_II(c,&nbsp;d,&nbsp;a,&nbsp;b,&nbsp;x[k&nbsp;+&nbsp;2],&nbsp;S43,&nbsp;0x2AD7D2BB);
        b&nbsp;=&nbsp;md5_II(b,&nbsp;c,&nbsp;d,&nbsp;a,&nbsp;x[k&nbsp;+&nbsp;9],&nbsp;S44,&nbsp;0xEB86D391);
        a&nbsp;=&nbsp;md5_AddUnsigned(a,&nbsp;AA);
        b&nbsp;=&nbsp;md5_AddUnsigned(b,&nbsp;BB);
        c&nbsp;=&nbsp;md5_AddUnsigned(c,&nbsp;CC);
        d&nbsp;=&nbsp;md5_AddUnsigned(d,&nbsp;DD);
    }
    return&nbsp;(md5_WordToHex(a)&nbsp;+&nbsp;md5_WordToHex(b)&nbsp;+&nbsp;md5_WordToHex(c)&nbsp;+&nbsp;md5_WordToHex(d)).toLowerCase();
}

</pre><div class="anchor-list">
<a name="3_7" class="lemma-anchor para-title" ></a>
<a name="sub7636_3_7" class="lemma-anchor " ></a>
<a name="伪代码实现" class="lemma-anchor " ></a>
</div><div class="para-title level-3" label-module="para-title">
<h3 class="title-text"><span class="title-prefix">MD5</span>伪代码实现</h3>
</div>
<div class="para" label-module="para">//Note:Allvariablesareunsigned32bitsandwrapmodulo2^32whencalculatingvarint[64]r,k//rspecifiestheper-roundshiftamountsr[0..15]:={7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22}r[16..31]:={5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20}r[32..47]:={4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23}r[48..63]:={6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21}//Usebinaryintegerpartofthesinesofintegersasconstants:forifrom0to63k[i]:=floor(abs(sin(i+1））×2^32）//Initializevariables:varinth0:=0x67452301varinth1:=0xEFCDAB89varinth2:=0x98BADCFEvarinth3:=0x10325476//Pre-processing:append&quot;1&quot;bittomessageappend&quot;0&quot;bitsuntilmessagelengthinbits≡448(mod512）appendbitlengthofmessageas64-bitlittle-endianintegertomessage//Processthemessageinsuccessive512-bitchunks:foreach512-bitchunkofmessagebreakchunkintosixteen32-bitlittle-endianwordsw[i],0≤i≤15//Initializehashvalueforthischunk:varinta:=h0varintb:=h1varintc:=h2varintd:=h3//Mainloop:forifrom0to63if0≤i≤15thenf:=(bandc)or((notb)andd)g:=ielseif16≤i≤31f:=(dandb)or((notd)andc)g:=（5×i+1）mod16elseif32≤i≤47f:=bxorcxordg:=（3×i+5）mod16elseif48≤i≤63f:=cxor(bor(notd))g:=（7×i)mod16temp:=dd:=cc:=bb:=((a+f+k[i]+w[g])leftrotater[i])+ba:=temp//Addthischunk&#39;shashtoresultsofar:h0:=h0+ah1:=h1+bh2:=h2+ch3:=h3+dvarintdigest:=h0appendh1appendh2appendh3//(expressedaslittle-endian)MD5加密工具</div>
<div class="para" label-module="para">利用MD5的算法原理，可以使用各种计算机语言进行实现，形成各种各样的MD5加密校验工具。有很多的在线工具可以实现这一点，这些在线工具一般是采用<a target=_blank href="/view/16168.htm">JavaScript</a>语言实现，使用非常方便快捷。<sup>[2]</sup><a class="sup-anchor" name="ref_[2]_7636">&nbsp;</a>
</div>
<div class="para" label-module="para">MD5优势</div>
<div class="para" label-module="para">Van oorschot和Wiener曾经考虑过一个在散列中暴力搜寻冲突的函数（brute-force hash function），而且他们猜测一个被设计专门用来搜索MD5冲突的机器（这台机器在1994年的制造成本大约是一百万美元）可以平均每24天就找到一个冲突。但单从1991年到2001年这10年间，竟没有出现替代MD5算法的MD6或被叫做其他什么名字的新算法这一点，我们就可以看出这个瑕疵并没有太多的影响MD5的安全性。上面所有这些都不足以成为MD5的在实际应用中的问题。并且，由于MD5算法的使用不需要支付任何版权费用的，所以在一般的情况下（非绝密应用领域。但即便是应用在绝密领域内，MD5也不失为一种非常优秀的中间技术），MD5怎么都应该算得上是非常安全的了。</div><div class="anchor-list">
<a name="4" class="lemma-anchor para-title" ></a>
<a name="sub7636_4" class="lemma-anchor " ></a>
<a name="弱点" class="lemma-anchor " ></a>
</div><div class="para-title level-2" label-module="para-title">
<h2 class="title-text"><span class="title-prefix">MD5</span>弱点</h2>
<a class="edit-icon j-edit-link" data-edit-dl="4" href="javascript:;"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_edit-lemma"></em>编辑</a>
</div>
<div class="para" label-module="para">2004年8月17日的美国<a target=_blank href="/view/526914.htm">加州</a>圣巴巴拉的国际<a target=_blank href="/view/25311.htm">密码学</a>会议（Crypto’2004）上，来自中国山东大学的<a target=_blank href="/view/350813.htm">王小云</a>教授做了破译MD5、HAVAL-128、 MD4和RIPEMD算法的报告，公布了MD系列算法的破解结果。宣告了固若金汤的世界通行密码标准MD5的堡垒轰然倒塌，引发了密码学界的轩然大波。(注意:并非是真正的破解，只是加速了杂凑冲撞）</div>
<div class="para" label-module="para">令世界顶尖密码学家想象不到的是，破解MD5之后，2005年2月，王小云教授又破解了另一国际密码SHA－1。因为SHA－1在美国等国际社会有更加广泛的应用，密码被破的消息一出，在国际社会的反响可谓石破天惊。换句话说，王小云的研究成果表明了从理论上讲电子签名可以伪造，必须及时添加限制条件，或者重新选用更为安全的密码标准，以保证电子商务的安全。<div class="lemma-picture text-pic layout-right" style="width:220px; float: right;">
<a class="image-link" nslog-type="9317" 
			href="/pic/MD5/212708/0/a005b33434b25e8fd0a2d3ce?fr=lemma&ct=single" target="_blank"
		title="MD5验证可执行文件不再可靠的消息" style="width:220px;height:183px;">
<img  class="lazy-img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF9fX1AAAA0VQI3QAAAAxJREFUeNpiYAAIMAAAAgABT21Z4QAAAABJRU5ErkJggg==" data-src="http://f.hiphotos.baidu.com/baike/s%3D220/sign=3a1cfde7a9ec8a13101a50e2c7039157/5ab5c9ea15ce36d3b8095a383af33a87e950b1ad.jpg"  alt="MD5验证可执行文件不再可靠的消息" style="width:220px;height:183px;"/>
</a>
<span class="description">
MD5验证可执行文件不再可靠的消息
</span>
</div>MD5破解工程权威网站是为了公开征集专门针对MD5的攻击而设立的，网站于2004年8月17日宣布：“<a target=_blank href="/view/832876.htm">中国研究</a>人员发现了完整MD5算法的碰撞；Wang,Feng,Lai,Yu公布了MD5、MD4、HAVAL-128、RIPEMD-128几个 Hash函数的碰撞。这是近年来<a target=_blank href="/view/25311.htm">密码学</a>领域最具实质性的研究进展。使用他们的技术，在数个小时内就可以找到MD5碰撞。……由于这个里程碑式的发现，MD5CRK项目将在随后48小时内结束”。</div>
<div class="para" label-module="para">在2004年8月之前，国际密码学界对<a target=_blank href="/subview/350813/7544439.htm" data-lemmaid="29050">王小云</a>这个名字并不熟悉。2004年8月，在美国<a target=_blank href="/view/526914.htm">加州</a>圣芭芭拉召开的国际密码大会上，并没有被安排发言的王小云教授拿着自己的研究成果找到<a target=_blank href="/view/1334437.htm">会议主席</a>，没想到慧眼识珠的会议主席破例给了她15分钟时间来介绍自己的成果，而通常发言人只被允许有两三分钟的时间。王小云与助手展示了MD5、SHA-0及其他相关杂凑函数的杂凑冲撞。所谓杂凑冲撞指两个完全不同的讯息经杂凑函数计算得出完全相同的杂凑值。根据<a target=_blank href="/view/39756.htm">鸽巢原理</a>，以有长度限制的杂凑函数计算没有长度限制的讯息是必然会有冲撞情况出现的。可是，一直以来，电脑保安专家都认为要任意制造出冲撞需时太长，在实际情况上不可能发生，而王小云等的发现可能会打破这个必然性。就这样，王小云在国际会议上首次宣布了她及她的研究小组的研究成果——对<a target=_blank href="/view/444142.htm">MD4</a>、MD5、HAVAL-128和<a target=_blank href="/view/260854.htm">RIPEMD</a>等四个著名密码算法的破译结果。</div>
<div class="para" label-module="para">在公布到第三个成果的时候，会场上已经是掌声四起，报告不得不一度中断。报告结束后，所有与会专家对他们的突出工作报以长时间的掌声，有些学者甚至起立鼓掌以示他们的祝贺和敬佩。由于版本问题，作者在提交<a target=_blank href="/view/3781591.htm">会议论文</a>时使用的一组常数和先行标准不同，在发现这一问题之后，王小云教授立即改变了那个常数，在很短的时间内就完成了新的数据分析，这段有惊无险的小插曲更证明了他们论文的信服力，攻击方法的有效性，验证了研究工作的成功。</div>
<div class="para" label-module="para">2005年8月，王小云、<a target=_blank href="/view/575406.htm">姚期智</a>，以及姚期智妻子<a target=_blank href="/view/1801633.htm">姚储枫</a>（即为Knuth起名<a target=_blank href="/view/119444.htm">高德纳</a>的人）联手于国际密码讨论年会尾声部份提出SHA-1杂凑函数杂凑冲撞演算法的改良版。此改良版使破解SHA-1时间缩短。</div>
<div class="para" label-module="para">2006年6月8日，<a target=_blank href="/view/350813.htm">王小云</a>教授于中国科学院第13次院士大会和<a target=_blank href="/view/11142.htm">中国工程院</a>第8次院士大会上以“国际通用Hash函数的破解”获颁<a target=_blank href="/view/262790.htm">陈嘉庚科学奖</a>信息技术科学奖。</div>
<div class="para" label-module="para">2009年，冯登国、谢涛二人利用差分攻击，将MD5的碰撞算法复杂度从王小云的2^42进一步降低到2^21，极端情况下甚至可以降低至2^10。仅仅2^21的复杂度意味着即便是在2008年的计算机上，也只要几秒便可以找到一对碰撞。<sup>[1]</sup><a class="sup-anchor" name="ref_[1]_7636">&nbsp;</a>
</div>
<div class="para" label-module="para">空字符串</div>
<div class="para" label-module="para">MD5("")= d41d8cd98f00b204e9800998ecf8427e<sup>[3]</sup><a class="sup-anchor" name="ref_[3]_7636">&nbsp;</a>
</div>
<div class="para" label-module="para">PHP md5() 函数定义和用法</div>
<div class="para" label-module="para">md5() 函数计算字符串的 MD5 散列。<sup>[4]</sup><a class="sup-anchor" name="ref_[4]_7636">&nbsp;</a>
</div>
<div class="para" label-module="para">md5() 函数使用 RSA 数据安全，包括 MD5 报文摘要算法。</div>
<div class="para" label-module="para">来自 RFC 1321 的解释 - MD5 报文摘要算法：<i>MD5 报文摘要算法将任意长度的信息作为输入值，并将其换算成一个 128 位长度的"指纹信息"或"报文摘要"值来代表这个输入值，并以换算后的值作为结果。MD5 算法主要是为数字签名应用程序而设计的；在这个数字签名应用程序中，较大的文件将在加密（这里的加密过程是通过在一个密码系统下[如：RSA]的公开密钥下设置私有密钥而完成的）之前以一种安全的方式进行压缩。</i></div>
<div class="para" label-module="para">如需计算文件的 MD5 散列，请使用 md5_file() 函数。</div>
<div class="para" label-module="para">语法</div>
<div class="para" label-module="para">md5(<i>string,raw</i>)</div>
<div class="para" label-module="para">参数描述<i>string</i>必需。规定要计算的字符串。<i>raw</i>可选。规定十六进制或二进制输出格式：</div>
<ul class="custom_dot  para-list list-paddingleft-1"><li class="list-dot list-dot-paddingleft"><div class="para" label-module="para">TRUE - 原始 16 字符二进制格式</div>
</li><li class="list-dot list-dot-paddingleft"><div class="para" label-module="para">FALSE - 默认。32 字符十六进制数</div>
</li></ul><div class="para" label-module="para">技术细节</div>
<div class="para" label-module="para">返回值：</div>
<div class="para" label-module="para">如果成功则返回已计算的 MD5 散列，如果失败则返回 FALSE。</div>
<div class="para" label-module="para">PHP 版本：</div>
<div class="para" label-module="para">4+</div>
<div class="para" label-module="para">更新日志：</div>
<div class="para" label-module="para">在 PHP 5.0 中，<i>raw</i> 参数变成可选的。</div>
<div class="para" label-module="para">实例</div>
<div class="para" label-module="para">输出 md5() 的结果：</div>
<div class="para" label-module="para">&lt;?php$str="Hello";echo"Thestring:".$str."&lt;br&gt;";echo"TRUE-Raw16characterbinaryformat:".md5($str,TRUE)."&lt;br&gt;";echo"FALSE-32characterhexnumber:".md5($str)."&lt;br&gt;";?&gt;</div>
<div class="anchor-list">
<a name="a" class="lemma-anchor a" ></a>
</div><div class="album-list">
<div class="header">
<span class="title">词条图册</span>
<a class="more-link" href="/pic/MD5/212708?fr=lemma" target="_blank" nslog-type="10000204">更多图册<em></em></a>
</div>
<div class="scroller">
<div class="list">
</div>
</div>
<div class="footer">
</div>
</div>
<dl class="lemma-reference collapse nslog-area log-set-param" data-nslog-type="2" log-set-param="ext_reference">
<dt class="reference-title">参考资料<em class="toggle"></em></dt>
<dd class="reference-list-wrap">
<ul class="reference-list">
<li class="reference-item " id="reference-[1]-7636-wrap">
<span class="index">1.</span>
<a class="gotop anchor"  name="refIndex_1_7636" id="refIndex_1_7636" title="向上跳转" href="#ref_[1]_7636">&nbsp;&nbsp;</a>
<a rel="nofollow" href="http://baike.baidu.com/redirect/d294XitEu2AW7c-02gu5_R04DPSqPfl7sOuSZJ-2JjO3DU84PlXerocEKSklbWNKKk3VyhvdRL_LfUGtnC7b2Q" target="_blank" class="text">How To Find Weak Input Differences For MD5 Collision Attacks<span class="linkout">&nbsp;</span></a>
<span class="site">．International Association for Cryptologic Research</span><span>．2009年</span><span>&#91;引用日期2012-10-28&#93;</span></li><li class="reference-item " id="reference-[2]-7636-wrap">
<span class="index">2.</span>
<a class="gotop anchor"  name="refIndex_2_7636" id="refIndex_2_7636" title="向上跳转" href="#ref_[2]_7636">&nbsp;&nbsp;</a>
<a rel="nofollow" href="http://baike.baidu.com/redirect/2d77BWTMkosceQCZXALbYRqm1L6Y6jqzdjZkGwaj0cOf1uaxobGJGNzQm_q3KSSBry-jqCc1GqFn57toRGI" target="_blank" class="text">哈希加密算法 MD5 - aTool在线工具<span class="linkout">&nbsp;</span></a>
<span class="site">．aTool在线工具</span><span>&#91;引用日期2013-12-16&#93;</span></li><li class="reference-item " id="reference-[3]-7636-wrap">
<span class="index">3.</span>
<a class="gotop anchor"  name="refIndex_3_7636" id="refIndex_3_7636" title="向上跳转" href="#ref_[3]_7636">&nbsp;&nbsp;</a>
<a rel="nofollow" href="http://baike.baidu.com/redirect/10acvPlJM827DDkJReBO12hg7RCRju5DzgsvVoy7m6gq-HNa9TbIMf7XZofEHMypCzY2DY92Opf_-wRj4A" target="_blank" class="text">维基<span class="linkout">&nbsp;</span></a>
<span class="site">．维基</span><span>&#91;引用日期2013-02-3&#93;</span></li><li class="reference-item " id="reference-[4]-7636-wrap">
<span class="index">4.</span>
<a class="gotop anchor"  name="refIndex_4_7636" id="refIndex_4_7636" title="向上跳转" href="#ref_[4]_7636">&nbsp;&nbsp;</a>
<a rel="nofollow" href="http://baike.baidu.com/redirect/10e3UEOqvb_VCMmskNmqH_Po61NCr1tbOtbTz7z6RYF28qiQJs53CVgx2YKREArjAVED9UrCW3XF3v0SV1eQ9Kju_7CbwGT80b4kNno" target="_blank" class="text">PHP MD5函数<span class="linkout">&nbsp;</span></a>
<span class="site">．w3cschool</span><span>．2014-02-2</span><span>&#91;引用日期2014-03-2&#93;</span></li></ul>
</dd>
</dl>
<div id="open-tag">
<div class="open-tag-title">词条标签：</div>
<dd id="open-tag-item">
<span class="taglist">
软件
</span>
，<span class="taglist">
工业技术
</span>
，<span class="taglist">
互联网
</span>
</dd>
<div class="open-tag-collapse" id="open-tag-collapse"></div>
</div>
<div class="clear"></div>
</div>
<div class="side-content">
<div class="summary-pic" >
<a href="/pic/MD5/212708/0/00e93901213fb80ee289b6db35d12f2eb9389466?fr=lemma&amp;ct=single" target="_blank" nslog-type="10002401">
<img src="http://b.hiphotos.baidu.com/baike/w%3D268%3Bg%3D0/sign=62884958004f78f0800b9df5410a6d68/00e93901213fb80ee289b6db35d12f2eb9389466.jpg" />
<button class="picAlbumBtn"><em></em><span>图集</span></button>
<div>MD5图册</div>
</a>
</div>
<div id="promotion_xunke"></div>
<div class="lemmaWgt-promotion-vbaike">
<div class="promotion_title">V百科<a href="/vbaike#gallary" target="_blank">往期回顾</a></div>
<div class="promotion_viewport">
<dl>
</dl>
<div class="promotion_viewport_pager"></div>
</div>
</div><div class="lemmaWgt-promotion-rightPreciseAd" data-lemmaId="212708" data-lemmaTitle="MD5"></div><div class="lemmaWgt-sideRecommend">
<a name="zhixinWrap" class="qnAnchor"></a>
<div class="zhixin-box" id="zhixinWrap" data-source="" data-newLemmaId="212708">
</div>
<form id="zhixinErrorForm" class="hidden" action="http://f3.baidu.com/index.php/feedback/zx/baikeJC" target="zhixinSubErr" method="post">
<input class="js-url" name="fb_html_url" type="hidden" />
<input class="js-query" name="fb_query" type="hidden" />
<input class="js-title" name="fb_card_title" type="hidden" />
<input class="js-content" name="fb_content" type="hidden" />
<input class="js-souceId" name="fb_source_id" type="hidden" />
</form>
<iframe id="zhixinSubErr" name="zhixinSubErr" style="display:none" frameborder="0"></iframe>
</div><div class="lemmaWgt-promotion-slide">
<div class="promotion_viewport">
<dl>
</dl>
<div class="promotion_viewport_pager"></div>
</div>
</div><div class="lemmaWgt-promotion-rightBigAd">
</div><dl class="side-box lemma-statistics">
<dt class="title">词条统计</dt>
<dd class="description">
<ul>
<li>浏览次数：<span id="j-lemmaStatistics-pv"></span>次</li>
<li>编辑次数：133次<a href="/historylist/MD5/212708" class="nslog:1021" target="_blank">历史版本</a></li>
<li>最近更新：<span class="j-modified-time" style="display:none">2016-01-22</span></li>
<li>创建者：<a class="show-userCard" data-uid="8553538" title="查看此用户资料" target="_blank" href="http://www.baidu.com/p/shdiao" nslog-type="1022">shdiao</a></li>
</ul>
</dd>
</dl>
<div class="side-catalog" style="visibility:hidden">
<div class="side-bar">
<em class="circle start"></em>
<em class="circle end"></em>
</div>
<div class="catalog-scroller">
<dl class="catalog-list">
<dt class="catalog-title level1">
<em class="pointer"></em>
<a href="#1" class="title-link">
<span class="text">
<span class="title-index">1</span>
<span class="title-link" nslog-type="1026">发展历史</span>
</span>
</a>
</dt>
<dd class="catalog-title level2">
<a href="#1_1" class="title-link">
<span class="text">
<span class="title-index">1.1</span>
<span class="title-link" nslog-type="1026">MD2</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#1_2" class="title-link">
<span class="text">
<span class="title-index">1.2</span>
<span class="title-link" nslog-type="1026">MD4</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#1_3" class="title-link">
<span class="text">
<span class="title-index">1.3</span>
<span class="title-link" nslog-type="1026">MD5</span>
</span>
</a>
</dd>
<dt class="catalog-title level1">
<em class="pointer"></em>
<a href="#2" class="title-link">
<span class="text">
<span class="title-index">2</span>
<span class="title-link" nslog-type="1026">MD5应用</span>
</span>
</a>
</dt>
<dd class="catalog-title level2">
<a href="#2_1" class="title-link">
<span class="text">
<span class="title-index">2.1</span>
<span class="title-link" nslog-type="1026">一致性验证</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#2_2" class="title-link">
<span class="text">
<span class="title-index">2.2</span>
<span class="title-link" nslog-type="1026">数字签名</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#2_3" class="title-link">
<span class="text">
<span class="title-index">2.3</span>
<span class="title-link" nslog-type="1026">安全访问认证</span>
</span>
</a>
</dd>
<dt class="catalog-title level1">
<em class="pointer"></em>
<a href="#3" class="title-link">
<span class="text">
<span class="title-index">3</span>
<span class="title-link" nslog-type="1026">算法原理</span>
</span>
</a>
</dt>
<dd class="catalog-title level2">
<a href="#3_1" class="title-link">
<span class="text">
<span class="title-index">3.1</span>
<span class="title-link" nslog-type="1026">原理</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_2" class="title-link">
<span class="text">
<span class="title-index">3.2</span>
<span class="title-link" nslog-type="1026">MD5加密字符串实例</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_3" class="title-link">
<span class="text">
<span class="title-index">3.3</span>
<span class="title-link" nslog-type="1026">C++实现</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_4" class="title-link">
<span class="text">
<span class="title-index">3.4</span>
<span class="title-link" nslog-type="1026">JAVA实现</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_5" class="title-link">
<span class="text">
<span class="title-index">3.5</span>
<span class="title-link" nslog-type="1026">VB2010实现</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_6" class="title-link">
<span class="text">
<span class="title-index">3.6</span>
<span class="title-link" nslog-type="1026">JavaScript实现</span>
</span>
</a>
</dd>
<dd class="catalog-title level2">
<a href="#3_7" class="title-link">
<span class="text">
<span class="title-index">3.7</span>
<span class="title-link" nslog-type="1026">伪代码实现</span>
</span>
</a>
</dd>
<dt class="catalog-title level1">
<em class="pointer"></em>
<a href="#4" class="title-link">
<span class="text">
<span class="title-index">4</span>
<span class="title-link" nslog-type="1026">弱点</span>
</span>
</a>
</dt>
<a class="arrow" href="javascript:void(0);"></a>
</dl>
</div>
<div class="right-wrap">
<a class="go-up disable" href="javascript:void(0);"></a>
<a class="go-down" href="javascript:void(0);"></a>
</div>
<div class="bottom-wrap">
<a class="toggle-button" href="javascript:void(0);"></a>
<a class="gotop-button" href="javascript:void(0);"></a>
</div>
</div>
<div class="unionAd_fromPs side-box" id="unionAd_fromPs">
<script type="BAIDU_HH">
    {
        type : 'pageembed',
        di   : 'u2140330',
        rsi0 : 270,
        rsi1 : 175
    }
    </script>
</div>
<div id="side_box_fengchao" class="fengchao side-box" nslog="area" nslog-type="10000902">
</div>
<div id="side_box_unionAd" class="unionAd side-box">
<div class="union-content"></div>
</div>
</div>
</div>
</div>
<div class="after-content">
<div class="fc-guess-like new" id="fc_guess_like_new">
<span class="logo-du">
<em class="cmn-icon cmn-icons cmn-icons_logo-du"></em>
</span>
<h6>猜你喜欢</h6>
<ul class="cmn-clearfix">
</ul>
</div>
<div class="bottom-promotion" id="bottom-promotion">
<div id="BOTTOM_PRO_AD"></div>
</div></div>
</div>

<div class="wgt-footer-main">
<div class="content">
<dl class="fresh">
<dt><em class="cmn-icon cmn-icons cmn-icons_footer-fresh"></em>新手上路</dt>
<dd>
<div><a target="_blank" href="/usercenter/tasks#guide">成长任务</a></div>
<div><a target="_blank" href="/help#main01">编辑入门</a></div>
<div><a target="_blank" href="/help#main06">编辑规则</a></div>
<div><a target="_blank" href="/help#main05">百科术语</a></div>
</dd>
</dl>
<dl class="question">
<dt><em class="cmn-icon cmn-icons cmn-icons_footer-question"></em>我有疑问</dt>
<dd>
<div><a target="_blank" href="/wikiui/doubt?lemmaId=212708&fr=lemma"
            nslog-type="10070001">我要质疑</a></div>
<div><a target="_blank" href="http://ikefu.baidu.com/baidubaike/chat.html" nslog-type="10000003">我要提问</a></div>
<div><a target="_blank" href="http://tieba.baidu.com/f?ie=utf-8&fr=bks0000&kw=%E7%99%BE%E5%BA%A6%E7%99%BE%E7%A7%91">参加讨论</a></div>
<div><a target="_blank" href="/feedback">意见反馈</a></div>
</dd>
</dl>
<dl class="suggestion">
<dt><em class="cmn-icon cmn-icons cmn-icons_footer-suggestion"></em>投诉建议</dt>
<dd>
<div><a target="_blank" href="http://tousu.baidu.com/baike#1">举报不良信息</a></div>
<div><a target="_blank" href="http://tousu.baidu.com/baike#2">未通过词条申诉</a></div>
<div><a target="_blank" href="http://tousu.baidu.com/baike#4">投诉侵权信息</a></div>
<div><a target="_blank" href="http://tousu.baidu.com/baike#3">封禁查询与解封</a></div>
</dd>
</dl>
</div>
<div class="copyright">©2016Baidu&nbsp;<a href="http://www.baidu.com/duty/" target="_blank">使用百度前必读</a>&nbsp;|&nbsp;<a href="http://help.baidu.com/question?prod_en=baike&class=159&id=1047" target="_blank">百科协议</a>&nbsp;|&nbsp;<a href="/operation/cooperation" target="_blank">百度百科合作平台</a></div>
</div>

<div class="lemmaWgt-searchHeader">
<div class="layout">
<div class="logo-container">
<a class="logo cmn-inline-block" title="到百科首页" href="/">
<span class="cmn-baike-logo">
<em class="cmn-icon cmn-icons cmn-icons_logo-bai"></em>
<em class="cmn-icon cmn-icons cmn-icons_logo-du"></em>
<em class="cmn-icon cmn-icons cmn-icons_logo-baike"></em>
</span>
</a>
</div>
<div class="search">
<div class="form">
<form id="searchForm" action="/search/word" method="GET" target="_self">
<input id="query" name="word" type="text" autocomplete="off" autocorrect="off" value="MD5" /><a id="search" href="javascript:;"><em class="cmn-icon wiki-lemma-icons wiki-lemma-icons_search" nslog-type="10010004"></em></a>
</form>
<ul id="suggestion" class="suggestion">
<div></div>
<li class="extra">
<span id="close">关闭</span>
</li>
</ul>
</div>
</div>
<div class="tool-buttons">
<a class="toolButtons-edit button j-edit-link" href="javascript:;" nslog-type="10010001"></a>
<a class="toolButtons-collect button" href="javascript:;" nslog-type="10010002"></a>
<a class="toolButtons-vote button" href="javascript:;" nslog-type="10010003"></a>
</div>
<div class="user-info">
<a class="user-link unlogin" href="javascript:;" nslog-type="10010005" target="_blank">登录</a>
</div>
</div></div>
<div class="new-bdsharebuttonbox new-side-share" id="side-share">
<span class="title">分享</span>
<div class="side-border">
<div class="triangle"></div>
<a class="bds_qzone"  href="javascript:void(0);" nslog-type="10060101">
<em class="cmn-icon cmn-icons cmn-icons_logo-qzone"></em>
</a>
<a class="bds_tsina" href="javascript:void(0);" nslog-type="10060301">
<em class="cmn-icon cmn-icons cmn-icons_logo-sina-weibo"></em>
</a>
<a class="bds_wechat"  href="javascript:void(0);" nslog-type="10060001">
<em class="cmn-icon cmn-icons cmn-icons_logo-wechat"></em>
</a>
<a class="bds_tqq"  href="javascript:void(0);" nslog-type="10060201">
<em class="cmn-icon cmn-icons cmn-icons_logo-qq"></em>
</a>
</div>
</div>
<div class="qrcode-wrapper" id="layer" style="display: none">
<div class="bd_weixin_popup_header">
<em class="cmn-icon cmn-icons cmn-icons_close"></em>
<span>分享到微信朋友圈</span>
</div>
<div id="wechat-qrcode-img"></div>
<div class="bd_weixin_popup_footer">打开微信“扫一扫”即可将网页分享至朋友圈</div>
</div>
<div></div><div></div>
</body><script type="text/javascript" src="http://baike.bdimg.com/static/wiki-common/pkg/wiki-common_sync_js_0_29c88fe.js"></script>
<script type="text/javascript">require.resourceMap({"res":{"wiki-lemma:widget/lemma_content/mainContent/lemmaRelation/lemmaInsert.js":{"url":"http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/mainContent/lemmaRelation/lemmaInsert_17d225d.js","pkg":"wiki-lemma:p5","deps":["wiki-common:widget/component/nslog/nslog.js"]},"wiki-lemma:widget/lemma_content/mainContent/lemmaRelation/tangram.js":{"url":"http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/mainContent/lemmaRelation/tangram_1e4b3aa.js","pkg":"wiki-lemma:p5"},"wiki-lemma:widget/lemma_content/mainContent/lemmaReference/lemmaReferenceTip/lemmaReferenceTip.js":{"url":"http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/mainContent/lemmaReference/lemmaReferenceTip/lemmaReferenceTip_d50e02d.js","deps":["wiki-common:widget/lib/jquery/jquery.js","wiki-common:widget/util/string.js"]}},"pkg":{"wiki-lemma:p5":{"url":"http://baike.bdimg.com/static/wiki-lemma/pkg/wiki-lemma-module-lemmaRelation_782158b.js"}}});</script><script type="text/javascript" src="http://baike.bdimg.com/static/wiki-common/widget/lib/jsmart/PHPJS_3347e0a.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-common/pkg/wiki-common_sync_js_1_ec0cd21.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-common/pkg/wiki-common_sync_js_2_7a24e62.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-common/pkg/wiki-common_sync_js_5_62d9343.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/pkg/wiki-lemma_921f707.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/XRegExp_3e3f85b.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/shCore_e2d4316.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/shBrushCpp_7f8b885.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/shBrushJava_c366450.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/shBrushVb_48ac0d7.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/lemmaCode/script/shBrushJScript_db5a222.js"></script>
<script type="text/javascript" src="http://baike.bdimg.com/static/wiki-lemma/widget/lemma_content/configModule/zhixin/zhixin_d2befc8.js"></script>
<script type="text/javascript">!function(){  var $ = require('wiki-common:widget/lib/jquery/jquery.js'),
    userbar = require('wiki-common:widget/component/userbar/userbar.js');
    
  $(function() {
    userbar.buildUserbar($('.wgt-userbar'), null);
  });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js'),
      initSearchbar = require('wiki-common:widget/component/searchbar/searchbar.js');  
    initSearchbar($('.wgt-searchbar-main'));
  }();
!function(){  var $ = require('wiki-common:widget/lib/jquery/jquery.js');

  var timer = '';

  $('.wgt-navbar').on('mouseenter', 'dl', function() {
  clearTimeout(timer);
  timer = setTimeout(function() {
  $('.wgt-navbar').addClass('wgt-navbar-hover');
}, 300);
}).on('mouseleave', function() {
clearTimeout(timer);
$('.wgt-navbar').removeClass('wgt-navbar-hover');
}).on('click', 'a', function() {
clearTimeout(timer);
$('.wgt-navbar').removeClass('wgt-navbar-hover');
});
}();
!function(){                var $ = require('wiki-common:widget/lib/jquery/jquery.js');
                var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

                // 展现策略
                rightCheck.editView('212708', function(res) {
                    if (!res.errno) {
                        if (res.data.edit) {
                            $('.lemmaWgt-lemmaTitle .add-subLemma').css('display', 'inline-block');
                            $('.top-tool .add-sub-icon').css('display', 'inline-block');
                        }
                    } else {
                        if ('1') {
                            $('.lemmaWgt-lemmaTitle .add-subLemma').css('display', 'inline-block');
                            $('.top-tool .add-sub-icon').css('display', 'inline-block');
                        }
                    }
                });
                require('wiki-lemma:widget/basicElement/addSub/addSub.js')({                    lemmaId: '212708',                    lemmaTitle: 'MD5',                    lemmaDesc: '',                    versionId: '103610698',                    subLemmaId: '7636'                });
            }();
!function(){        var $ = require('wiki-common:widget/lib/jquery/jquery.js');
        var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

        // 展现策略
        rightCheck.editView('212708', function(res) {
            if (!res.errno) {
                if (res.data.divide) {
                    $('.top-tool .split-icon').css('display', 'block');
                }
            }
        });
    }();
!function(){    var nslog = require('wiki-common:widget/component/nslog/nslog.js');
	require.async("wiki-lemma:widget/basicElement/collect/collect.js",function(collect){
		collect({
            newLemmaId:"212708",
			lemmaId:"7636",
			subLemmaId:"7636"
		});
	});
}();
!function(){    var nslog = require('wiki-common:widget/component/nslog/nslog.js');
	require.async("wiki-lemma:widget/basicElement/vote/vote.js",function(vote){
		vote({
			lemmaId:"7636",
            subLemmaId:"7636",
            newLemmaId:"212708"
		});
	});
}();
!function(){    var nslog = require('wiki-common:widget/component/nslog/nslog.js');
	!!window.BKShare && window.BKShare.regist({
		"tag" : "top-share",
		"bdSize" : 32,
		"bdMini":1
	});
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.lemmaWgt-lemmaTitle .edit-lemma').css('display', 'inline-block');
            } else {
                $('.lemmaWgt-lemmaTitle .lock-lemma').show();
            }
        } else {
            if ('1') {
                $('.lemmaWgt-lemmaTitle .edit-lemma').css('display', 'inline-block');
            } else {
                $('.lemmaWgt-lemmaTitle .lock-lemma').show();
            }
        }
    });
}();
!function(){	require('wiki-lemma:widget/lemma_content/mainContent/basicInfo/basicInfo.js')();
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

    // 展现策略
    rightCheck.editView('212708', function(res) {
        if (!res.errno) {
            if (res.data.edit) {
                $('.para-title .edit-icon').css('display', 'block');
            }
        } else {
            if ('1') {
                $('.para-title .edit-icon').css('display', 'block');
            }
        }
    });
}();
!function(){        SyntaxHighlighter.all();
    }();
!function(){	require.async(["wiki-common:widget/lib/jquery/jquery.js", "wiki-lemma:widget/lemma_content/mainContent/albumList/albumList.js", "wiki-common:widget/component/nslog/nslog.js"],function($,AlbumList,nslog){
		var list=new AlbumList({
			newLemmaId:"212708",
			lemmaTitle:"MD5",
			lemmaId:"7636",
			subLemmaId:"7636",
			data:[{"coverpic":"00e93901213fb80ee289b6db35d12f2eb9389466","desc":"\u8bcd\u6761\u56fe\u7247","total":7,"coverurl":"http:\/\/b.hiphotos.baidu.com\/baike\/s%3D235\/sign=bc4836162b34349b70066986fceb1521\/00e93901213fb80ee289b6db35d12f2eb9389466.jpg"}]
		});
		!!window.ScriptLazyLoad && window.ScriptLazyLoad.regist({
			dom:$('.album-list'),
			loadFunc:function(){
				list.load();
				nslog(1258);
			},
			distance:500
		});
	});
}();
!function(){		require.async(["wiki-lemma:widget/lemma_content/mainContent/lemmaReference/lemmaReference.js", "wiki-lemma:widget/lemma_content/mainContent/lemmaReference/lemmaReferenceTip/lemmaReferenceTip.js"],function(Reference,ReferenceTip){
			new Reference({
				subLemmaId:"7636"
			});
			new ReferenceTip({
				subLemmaId:"7636"
			});
		});
	}();
!function(){        require.async("wiki-common:widget/lib/jquery/jquery.js",function($){
            function openTagToggle(node) {
                if ($(node).hasClass("collapse")) {
                    $(node).removeClass("collapse");
                    $("#open-tag").css("height", '22px');
                } else {
                    $(node).addClass("collapse");
                    $("#open-tag").css("height", $("#open-tag-item").css("height"));
                }
            }
            if (parseInt($("#open-tag-item").css("height")) <= 30) {
                $('#open-tag-collapse').hide();
            }
            $("#open-tag-collapse").on("click", function () {
                openTagToggle($("#open-tag")[0]);
            });
        });
    }();
!function(){    require.async('wiki-lemma:widget/promotion/xunke/xunke.js', function (app) {
        app.init({
            lemmaTitle: 'MD5',
            adManager: null
        });
    });
}();
!function(){        require('wiki-lemma:widget/lemma_content/configModule/zhixin/zhixin.js')(
            212708,
            'MD5'
        );
    }();
!function(){    require.async("wiki-lemma:widget/lemma_content/mainContent/lemmaStatistics/lemmaStatistics.js",function(init){
        init({
            newLemmaIdEnc:"7aefb4f40a895b77f2dc75e4"
        });
    });
}();
!function(){	require.async("wiki-lemma:widget/lemma_content/mainContent/sideCatalog/sideCatalog.js",function(SideCatalog){
		new SideCatalog();
	});
}();
!function(){        require.async(['wiki-lemma:widget/promotion/unionAdFromPs/unionAdFromPs.js'], function (init) {
            init({
                adManager: null
            });
        });
    }();
!function(){    require.async(["wiki-lemma:widget/promotion/fengchao/fengchao.js", "wiki-lemma:widget/promotion/unionAd/unionAd.js"], function (init, unionAd) {
        init({
            newLemmaId: "212708",
            lemmaTitle: "MD5",
            encodeLemmaTitle: "MD5",
            adManager: null
        }, {
            errFn: unionAd,
            dom: $('#side_box_unionAd')
        });
    });
}();
!function(){    require.async('wiki-lemma:widget/promotion/guessLike/guessLike.js', function (app) {
        app.init({
            lemmaTitle: 'MD5',
            adManager: null
        });
    });
}();
!function(){        require.async('wiki-lemma:widget/promotion/bottomAd/bottomAd.js', function (init) {
            init({
                sId: 'BOTTOM_PRO_AD',
                adManager: null
            });
        });
    }();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var Dialog = require("wiki-common:widget/ui/dialog/dialog.js");
    var userLogin = require('wiki-common:widget/component/userLogin/userLogin.js');
    var unameFiller = require('wiki-common:widget/component/unameFiller/unameFiller.js');
    var rightCheck = require('wiki-lemma:widget/tools/rightCheck/rightCheck.js');

            var isEnterprise = false;
        var enterpriseOwnerUserId = 0;
    
    var userId = 0;
    var editUrl = '/edit/' + encodeURIComponent('MD5') + '/' + '212708';
    var pgcUrl = '/enterprise/editpgc?lemmaId=212708';

    userLogin.regist({
        onLogin: function(user) {
            userId = user ? user.uid : 0;
        }
    });

    function gotoEdit(url, isMidNight) {
        if (isMidNight) {
            Dialog.alert({
                title: '编辑提示',
                subMsg: '晚23:00至次日8:00，因审核系统例行维护，您提交的版本可能需要较长时间才能通过，望您谅解。',
                onConfirm: function() {
                    window.location.href = url;
                }
            });
        } else {
            window.location.href = url;
        }    
    }

    function showChoseEditDialog(pgcCallback, ugcCallback) {
        new Dialog({
            title: '编辑提示',
            subMsg: '<p>您已开通企业百科服务，推荐您直接编辑“官方资料”，官方资料仅限企业百科绑定的百科账号修改，其他用户账号不可修改。</p><p>如果您想修改其他网友编辑的普通词条内容，请注意遵守百科百科编辑规则。<p>',
            btns: [{
            key: 'pgc',
            text: '编辑官方资料'
            }, {
            style: 'white',
            text: '修改普通词条',
            key: 'ugc'
            }],
            onBtnClick: function(btnKey){
                if (btnKey === 'pgc') {
                    pgcCallback && pgcCallback();
                } else if (btnKey === 'ugc') {
                    ugcCallback && ugcCallback();
                }
            }
        }).show();
    }

    function checkUserLegal(res) {
        var legal = false;
        switch (res.errno) {
            case 100001:
                userLogin.showLoginPop();
                break;
            case 100006:
                unameFiller.show();
                break;
            default:
                legal = true;
        }
        return true;
    }

    function checkUgc(res, url) {
        if (res.errno) {
            switch (res.errno) {
                case 100005:
                    alert('对不起，您目前被封禁');
                    break;
                case 110001:
                    alert('对不起，该词条被锁定');
                    break;
                case 110007:
                    alert('对不起，消歧页无法编辑');
                    break;
                case 110005:
                    Dialog.alert({
                    title: '编辑提示',
                    mainMsg: '对不起，您暂时没有权限编辑该词条。',
                    subMsg: '<p>您好，该词条内容已较丰富，现仅对百科等级达到<b>四级</b>且通过率达到<b>85%</b>的科友开放编辑。</p><p>当您通过努力达到以上要求，就可以参与编辑该词条了。</p><p><img src="http://img.baidu.com/img/baike/usercenter/growuptask/star.gif" class="star" />参加<a target="_blank" href="/usercenter#guide">成长任务</a>，更快掌握百科编辑技巧，加速升级！</p>'
                    });
                    break;
                case 110008:
                    Dialog.alert({
                    title: '编辑提示',
                    mainMsg: '对不起，您暂时没有权限编辑该词条。',
                    subMsg: '<p>您好，该词条内容已较丰富，现仅对百科等级达到<b>六级</b>且通过率达到<b>85%</b>的科友开放编辑。</p><p>当您通过努力达到以上要求，就可以参与编辑该词条了。</p><p><img src="http://img.baidu.com/img/baike/usercenter/growuptask/star.gif" class="star" />参加<a target="_blank" href="/usercenter#guide">成长任务</a>，更快掌握百科编辑技巧，加速升级！</p>'
                    });
                    break;
                case 470001:
                    alert('系统错误，请刷新重试');
                    break;
            }
        } else {
            if (!res.data.right.noAudit) {
                Dialog.alert({
                    title: '编辑提示',
                    subMsg: '很抱歉，该词条有其他用户编辑的版本正在提交，您暂时无法编辑。<br/>百科建议您晚些时候再编辑该词条，或者尝试编辑其他的词条。'
                });
                return;
            }
            gotoEdit(url, res.data.notice.isMidNight);
        }
    }

    $(document.body).on('click', '.j-edit-link', function() {
        var dl = $(this).attr('data-edit-dl');
        if (dl) {
            var url = editUrl + '?dl=' + dl;
        } else {
            var url = editUrl;
        }

        rightCheck.preeditCheck('212708', 'MD5', 'MD5', '103610698', function(res) {
            if (!checkUserLegal(res)) {
                return;
            }
            if (isEnterprise && enterpriseOwnerUserId === userId) {
                showChoseEditDialog(function() {
                    location.href = pgcUrl;
                }, function() {
                    checkUgc(res, url);
                });
            } else {
                checkUgc(res, url);
            }
        });
    });
}();
!function(){    require.async("wiki-lemma:widget/tools/searchHeader/toolButtons/toolButtons.js",function(init){
        init({
            lemmaId:"7636",
            subLemmaId:"7636",
            newLemmaId:"212708"
        });
    });
}();
!function(){    require('wiki-lemma:widget/tools/searchHeader/toolButtons/userInfo.js')();
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js'),
      animation = require('wiki-common:widget/util/animation.js'),
      nslog = require('wiki-common:widget/component/nslog/nslog.js'),
      initSearchbar = require('wiki-common:widget/component/searchbar/searchbar.js');

    var isFadeIn = false,
        isFadeOut = false;

    var fadeInAni, fadeOutAni;

    $(window).on('scroll', function(e) {
        var scrollTop = $(this).scrollTop();

        if (scrollTop > 200 && !isFadeIn && $('.lemmaWgt-searchHeader').css('display') == 'none') {
            fadeOutAni && fadeOutAni.stop();
            fadeInAni = animation({
                duration: 200,
                easing: 'linear',
                onStart: function() {
                    isFadeOut = false;
                    isFadeIn = true;
                    $('.lemmaWgt-searchHeader').css('display', 'block');
                },
                onStep: function(progress) {
                    $('.lemmaWgt-searchHeader').css('opacity', progress)
                },
                onComplete: function(progress) {
                    isFadeIn = false;
                    nslog(10010006);
                }
            });
        } else if (scrollTop <= 200 && !isFadeOut && $('.lemmaWgt-searchHeader').css('display') == 'block') {
            fadeInAni && fadeInAni.stop();
            fadeOutAni = animation({
                duration: 300,
                easing: 'linear',
                onStart: function() {
                    $('.lemmaWgt-searchHeader #suggestion').hide();
                    isFadeIn = false;
                    isFadeOut = true;
                },
                onStep: function(progress) {
                    $('.lemmaWgt-searchHeader').css('opacity', 1 - progress);
                },
                onComplete: function(progress) {
                    isFadeOut = false;
                    $('.lemmaWgt-searchHeader').css('display', 'none');
                }
            });
        }
    });

    initSearchbar($('.lemmaWgt-searchHeader'));
}();
!function(){    require('wiki-lemma:widget/tools/newSideShare/qzopensl.js');
    require.async("wiki-lemma:widget/tools/newSideShare/taskSideShare.js",function(taskShare){
        taskShare.init({
            title: 'MD5',
            desc: "Message Digest Algorithm MD5\uff08\u4e2d\u6587\u540d\u4e3a\u6d88\u606f\u6458\u8981\u7b97\u6cd5\u7b2c\u4e94\u7248\uff09\u4e3a\u8ba1\u7b97\u673a\u5b89\u5168\u9886\u57df\u5e7f\u6cdb\u4f7f\u7528\u7684\u4e00\u79cd\u6563\u5217\u51fd\u6570\uff0c\u7528\u4ee5\u63d0\u4f9b\u6d88\u606f\u7684\u5b8c\u6574\u6027\u4fdd\u62a4\u3002\u8be5\u7b97\u6cd5\u7684\u6587\u4ef6\u53f7\u4e3aRFC 1321\uff08R.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992\uff09\u3002MD5\u5373Message-Digest Algorithm 5\uff08\u4fe1\u606f-\u6458\u8981\u7b97\u6cd55\uff09\uff0c\u7528\u4e8e\u786e\u4fdd\u4fe1\u606f\u4f20\u8f93\u5b8c\u6574\u4e00\u81f4\u3002\u662f",
            pic: 'http:\/\/b.hiphotos.baidu.com\/baike\/w%3D268\/sign=8cabd4efd639b6004dce08b1d1513526\/00e93901213fb80ee289b6db35d12f2eb9389466.jpg',
            url: '',
            qqPic: 'http:\/\/b.hiphotos.baidu.com\/baike\/whfpf%3D324%2C324%2C50\/sign=20772ac0c0cec3fd8b6bf435b0b5e70d\/00e93901213fb80ee289b6db35d12f2eb9389466.jpg'
        });
    });
}();
!function(){    var $ = require('wiki-common:widget/lib/jquery/jquery.js');
    var nslog = require("wiki-common:widget/component/nslog/nslog.js");
    var testElem = require('wiki-common:widget/component/testElem/testElem.js');
    var cmsModuleLoader = require('wiki-common:widget/component/cmsModuleLoader/cmsModuleLoader.js');

    function requireAsync() {
        require.async('wiki-lemma:widget/tools/announcement/announcement.js');
    }

    cmsModuleLoader('/cms/global/lemma_config.json', [{
        name: 'announcement',
        script: 'wiki-lemma:widget/tools/announcement/announcement.js'
    }]);

    require.async("wiki-lemma:widget/tools/lazyLoad/lazyLoad.js", function(LazyLoad) {
        new LazyLoad();
    });

    require.async(['wiki-common:widget/component/nslog/nslog.js', 'wiki-common:widget/lib/jquery/jquery.js'], function(nslog, $) {
        nslog().setGlobal({
            lemmaId: "7636",
            newLemmaId: "212708",
            subLemmaId: "7636",
            lemmaTitle: "MD5"
        });

        // 词条页 pv
        nslog(9322);

        // 新版头部pv（小流量）
        if ($('.pc-header-new').length > 0) {
            nslog(9069);
        }

        // 链接点击 pv
        var lemmaPageRegExp = new RegExp(/\/subview\/\d+|\/view\/\d+|\/item\//i);
        $('body').on('mousedown', 'a', function() {
            var href = $(this).attr('href');
            if (href && href.indexOf('/') >= 0 && href.indexOf('#') !== 0) {
                // 链接点击 pv
                nslog(10000001);
                if (lemmaPageRegExp.test(href)) {
                    // 词条页链接点击 pv
                    nslog(10000002, window.location.href, {
                        targetTitle: $(this).text()
                    });
                }
            }
        });

        /****** 词条页站内流转需求统计 start ******/
        (function () {
            // 各种统计配置
            var circulationLinkCfg = {
                innerLink: [ // 内链
                    '.para',
                    '.lemmaWgt-baseInfo-simple-largeMovie',
                    '.lemmaWgt-baseInfo-simple-largeStar',
                    '.basic-info .basicInfo-block',
                    '.lemma-summary',
                    '.lemmaWgt-lemmaSummary',
                    '.view-tip-panel',
                    '.horizontal-module',
                    '.lemmaWgt-roleIntroduction',
                    '.dramaSeries .dramaSerialList',
                    '.module-music',
                    '.table-view',
                    '[log-set-param="table_view"]',
                    '.list-module',
                    '.cell-module',
                    '.baseBox .dl-baseinfo', // 配置后台字段
                    '.pvBtn-box .leadPVBtnWrapper',
                    '.drama-actor',
                    '#staffList',
                    '.starMovieAndTvplay',
                    '.main_tab:not(.main_tab-defaultTab)' // 除去词条tab外的tab
                ],
                relationTable: '.rs-container-foot', // 关系表
                peopleRelation: '.star-info-block.relations, .lemmaWgt-focusAndRelation', // 人物关系（明星+普通）
                moduleActors: '.featureBaseInfo .actors, .lemmaWgt-majorActors', // 主要演员、嘉宾、主持人
                moduleWorks: '.featureBaseInfo .works, .large-feature .works', // 代表作品
                moduleQuarterly: '.featureBaseInfo .po_quarterly, .mian_quarterly', // 分季介绍
                rankStar: '.rank-list.stars-rank', // 明星榜
                rankDrama: '.drama-rank-list', // 电视剧榜
                specialTopic: '.special-topic', // 专题模块
                modDetailTable: '#modDetailTable', // 关系表出图
                chuizhitu: '.chuizhitu', // 垂直化模块
                polysemantList: '.polysemantList-wrapper' // 义项切换
            };
            /****** 连接统计 ******/
            function clickNslogFn() {
                for (var k in circulationLinkCfg) {
                    if (k === 'innerLink') {
                        // 词条内链到词条页
                        var tempArr = circulationLinkCfg[k];
                        for (var i = 0, l = tempArr.length; i < l; i++) {
                            tempArr[i] += ' a';
                        }
                        var sSelector = tempArr.join(', ');

                        $('body').on('mousedown', sSelector, {key: k},function(e) {
                            var key = e.data.key;
                            var href = $(this).attr('href');
                            var tar = $(this).attr('target') || '';
                            if (href && href.indexOf('/') >= 0 && href.indexOf('#') !== 0
                            && tar === '_blank' && lemmaPageRegExp.test(href)) {
                                // 词条页普通内链点击 pv
                                nslog(10000004, null ,{division: key});
                            }
                        });
                    } else {
                        // 模块到词条页链接
                        $(circulationLinkCfg[k]).on('mousedown', 'a', {key: k}, function (e) {
                            var key = e.data.key;
                            var href = $(this).attr('href');
                            if (href && href.indexOf('#') !== 0 && lemmaPageRegExp.test(href)) {
                                // 词条页配置模块链接点击 pv
                                nslog(10000004, null, {division: key});
                            }
                        });
                    }
                }
            }
            // 发起统计请求
            clickNslogFn();

            /****** 各模块展现量pv ******/
            function checkModuleIsShow() {
                var result = [];
                for (var k in circulationLinkCfg) {
                    if (k !== 'innerLink' && k !== 'relationTable') {
                        !!$(circulationLinkCfg[k]).html() && result.push(k);
                    }
                }
                if (result.length > 0) {
                    nslog(10000005, null, {showModules: result.join(',')});
                }
            }
            checkModuleIsShow();

        })();
        /****** 词条页站内流转需求统计 end ******/

    });

    // 广告接入 wikiad 统一加载
    // log 词条页广告被拦截情况（此处 log 请求行为）
    nslog(70000101, window.location.href, {
        api: 'lemma-ad',
        action: 'request'
    });
    $.ajax({
        type: 'GET',
        url: '/api/wikiad/getsquirrels',
        data: {
            lemmaId: 212708
        },
        cache: false,
        dataType: 'JSON',
        success: function (res) {
            // log 词条页广告被拦截情况（此处 log 请求成功）
            nslog(70000101, window.location.href, {
                api: 'lemma-ad',
                action: 'success'
            });

            if (!res.errno) {
                if (res.data[5]) {
                    require.async(['wiki-lemma:widget/promotion/rightPreciseAd/rightPreciseAd.js'], function(rightPreciseAd) {
                        rightPreciseAd(res.data[5]);
                        nslog(10002201, location.href, {
                            adId: res.data[5][0].adId,
                            adTitle: res.data[5][0].name,
                            adPos: 5
                        });
                    });
                } else if (res.data[1]) {
                    require.async(['wiki-lemma:widget/promotion/vbaike/vbaike.js'], function(vbaike) {
                        vbaike(res.data[1]);
                        for(var i in res.data[1]) {
                            nslog(10002201, location.href, {
                                adId: res.data[1][i].adId,
                                adTitle: res.data[1][i].name,
                                adPos: 1
                            });
                        }
                    });
                }
                if (res.data[9]) {
                    require.async(['wiki-lemma:widget/promotion/rightBigAd/rightBigAd.js'], function(rightBigAd) {
                        rightBigAd(res.data[9]);
                            nslog(10002201, location.href, {
                                adId: res.data[9][0].adId,
                                adTitle: res.data[9][0].name,
                                adPos: 9
                            });
                    });
                } else if(res.data[2]) {
                    require.async(['wiki-lemma:widget/promotion/slide/slide.js'], function(slide) {
                        slide(res.data[2]);
                        for(var i in res.data[2]) {
                            nslog(10002201, location.href, {
                                adId: res.data[2][i].adId,
                                adTitle: res.data[2][i].name,
                                adPos: 2
                            });
                        }
                    });
                }
                if (res.data[3]) {
                    require.async(['wiki-lemma:widget/promotion/topAd/topAd.js'], function(topAd) {
                        topAd(res.data[3]);
                        nslog(10002201, location.href, {
                            adId: res.data[3][0].adId,
                            adTitle: res.data[3][0].name,
                            adPos: 3
                        });
                    });
                }
                if (res.data[4]) {
                    require.async(['wiki-lemma:widget/promotion/rightAd/rightAd.js'], function(rightAd) {
                        rightAd(res.data[4]);
                        nslog(10002201, location.href, {
                            adId: res.data[4][0].adId,
                            adTitle: res.data[4][0].name,
                            adPos: 4
                        });
                    });
                }
                if (res.data[15]) {
                    require.async(['wiki-lemma:widget/promotion/banner/banner.js'], function(banner) {
                        banner(res.data[15]);
                        nslog(10002201, location.href, {
                            adId: res.data[15][0].adId,
                            adTitle: res.data[15][0].name,
                            adPos: 15
                        });
                    });
                }
                if (res.data[16]) {
                    require.async(['wiki-lemma:widget/promotion/declaration/declaration.js'], function(declaration) {
                        declaration(res.data[16]);
                        nslog(10002201, location.href, {
                            adId: res.data[16][0].adId,
                            adTitle: res.data[16][0].name,
                            adPos: 16
                        });
                    })
                }
            } else {
                return;
            }

            setTimeout(function () {
                var elemArr = {};
                res.data[1] && res.data[1].length > 0 && (elemArr['lemma-vbaike-ad'] = $('.lemmaWgt-promotion-vbaike .promotion_viewport a:eq(0) img').get(0));
                res.data[2] && res.data[2].length > 0 && (elemArr['lemma-slide-ad'] = $('.lemmaWgt-promotion-slide .promotion_viewport a:eq(0) img').get(0));
                res.data[3] && res.data[3].length > 0 && (elemArr['lemma-navbar-ad'] = {
                    node: $('.header [nslog-type="10002202"]').get(0),
                    validations: {
                        'noBackgroundImage': function() {
                            return $('.header [nslog-type="10002202"]').css('background-image').indexOf(res.data[3][0].picUrl) < 0
                        }
                    }
                });
                res.data[4] && res.data[4].length > 0 && (elemArr['lemma-side-ad'] = {
                    node: $('.right-ad img').get(0),
                    validations: {
                        'noBackgroundImage': function() {
                            return $('.right-ad img').attr('src').indexOf(res.data[4][0].picUrl) < 0
                        }
                    }
                });
                res.data[15] && res.data[15].length > 0 && (elemArr['lemma-configModule-banner'] = $('.configModuleBanner').get(0));
                res.data[16] && res.data[16].length > 0 && (elemArr['lemma-configModule-declaration'] = $('.lemmaWgt-declaration').get(0));

                testElem.log(elemArr, 70000102);
            }, 1000);
        },
        error: function () {
            // log 词条页广告被拦截情况（此处 log 请求失败）
            nslog(70000101, window.location.href, {
                api: 'lemma-ad',
                action: 'error'
            });
        }
    });

    // 设置分享内容
    window.BKShare.setCommon({
        bdText: "\u3010MD5_\u767e\u5ea6\u767e\u79d1\u3011Message Digest Algorithm MD5\uff08\u4e2d\u6587\u540d\u4e3a\u6d88\u606f\u6458\u8981\u7b97\u6cd5\u7b2c\u4e94\u7248\uff09\u4e3a\u8ba1\u7b97\u673a\u5b89\u5168\u9886\u57df\u5e7f\u6cdb\u4f7f\u7528\u7684\u4e00\u79cd\u6563\u5217\u51fd\u6570\uff0c\u7528\u4ee5\u63d0\u4f9b\u6d88\u606f\u7684\u5b8c\u6574\u6027\u4fdd\u62a4\u3002\u8be5\u7b97\u6cd5\u7684\u6587\u4ef6\u53f7\u4e3aRFC 1321\uff08R.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992\uff09\u3002MD5\u5373Message-Digest Algorithm 5\uff08\u4fe1\u606f-\u6458\u8981\u7b97\u6cd55\uff09\uff0c\u7528\u4e8e\u786e\u4fdd\u4fe1\u606f\u4f20\u8f93\u5b8c\u6574\u4e00\u81f4\u3002\u662f.....\uff08\u5206\u4eab\u81ea@\u767e\u5ea6\u767e\u79d1\uff09",
        bdDesc: '',
        bdUrl: 'http:\/\/baike.baidu.com\/subview\/7636\/7636.htm',
        bdPic: '',
        onBeforeClick: function (){
            $('.bdshare_dialog_box').hide();
        }
    });

    // 底部投诉带入当前页面 url
    var map = [1, 2, 4, 3];
    $('.wgt-footer-main .suggestion').find('a').each(function(i) {
        $(this).attr('href', 'http://tousu.baidu.com/baike/add?word=MD5' + '&&submit_link=' + encodeURIComponent(window.location.href) + '#' + map[i]);
    });
}();
!function(){      require('wiki-common:widget/component/psLink/psLink.js');
    }();</script><script type="text/javascript">(new Image()).src="https://gsp0.baidu.com/5aAHeD3nKhI2p27j8IqW0jdnxx1xbK/tb/pms/img/st.gif?pid=242&v=2&fs=d17c11e,6cf69d7,245a071,0c8a499,6989571,8489f15,3b87af4,5d75544,610f001,04b6dcb,6caef55,ea15059,1e698a5,4e6f885,a8d1422,f3869a1,e8122d1,08c0ca0,7c09ce8,16addac,bf8f8ff,1ec069b,429109e,599060d,9a244fa,6d3f55c,ff792b0,2f3cb53,d968012,63854a5,e3da08e,4751f41,8f25bc7,9d4c3fb,5ec9780,b6a75d6,fbad8c8,c3f013b,6c7071e,8ad3c5a,ff01574,7010ca0,b7162b1,a4b83dd,a5481f2,f781616,7b010e4,f770c7c,79f1b80,060d084,352b8ee,d2b396c,fcae7b0,bc8d043,93e2dbc,9ef720d,1e296fe,c2d6b6c,df2f43f,5e5bbf2,de21595,3863f12,a2c6e33,7d13e8e,9c3a8fa,f1f5abb,3e9410c,ba4de73,117d9c9,49d5515,03483af,4ebc297,52f3fd6,00cd86b,c02b5b1,e741536,aa8964e,1d27d9a,fa38f44,97ab102,912dba1,5a73c4a,0469f06,630e49a,b44b6c1,35aca65&otherStr=&page=wiki-lemma/page/normal/normal.tpl&sid=1482226094&hash=39ae61080e&fid=baike";</script>
<script type="text/javascript">
  var Hunter = window.Hunter || {};
  Hunter.userConfig = Hunter.userConfig || [];
  </script>
<script type="text/javascript" src="https://gss0.baidu.com/70cFsjip0QIZ8tyhnq/hunter/baike.js?st=17155" defer></script><script type="text/javascript">
  // DOM Ready时，统计用户可操作时间。
  alog('speed.set', 'drt', +new Date);

  void function(a,b,c,d,e,f){function g(b){a.attachEvent?a.attachEvent("onload",b,!1):a.addEventListener&&a.addEventListener("load",b)}function h(a,c,d){d=d||15;var e=new Date;e.setTime((new Date).getTime()+1e3*d),b.cookie=a+"="+escape(c)+";path=/;expires="+e.toGMTString()}function i(a){var c=b.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=c?unescape(c[2]):null}function j(){var a=i("PMS_JT");if(a){h("PMS_JT","",-1);try{a=a.match(/{["']s["']:(\d+),["']r["']:["']([\s\S]+)["']}/),a=a&&a[1]&&a[2]?{s:parseInt(a[1]),r:a[2]}:{}}catch(c){a={}}a.r&&b.referrer.replace(/#.*/,"")!=a.r||alog("speed.set","wt",a.s)}}if(a.alogObjectConfig){var k=a.alogObjectConfig.sample,l=a.alogObjectConfig.rand;if("https:"===a.location.protocol){if(d="https://gss2.bdstatic.com/70cFsjip0QIZ8tyhnq"+d,!k||!l)return}else d="http://img.baidu.com"+d;k&&l&&l>k||(g(function(){alog("speed.set","lt",+new Date),e=b.createElement(c),e.async=!0,e.src=d+"?v="+~(new Date/864e5),f=b.getElementsByTagName(c)[0],f.parentNode.insertBefore(e,f)}),j())}}(window,document,"script","/hunter/alog/dp.min.js");
</script>
</html>
